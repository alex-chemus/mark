{"version":3,"file":"js/383.62fe9ff3.js","mappings":"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","sources":["webpack://mark/./src/pages/NewReport/hooks/useAttendance.ts","webpack://mark/./src/pages/NewReport/hooks/useSaveReport.ts","webpack://mark/./src/pages/NewReport/hooks/useCreateReport.ts","webpack://mark/./src/pages/NewReport/hooks/useValidation.ts","webpack://mark/./src/pages/NewReport/NewReport.vue?2da3","webpack://mark/./src/pages/NewReport/NewReport.vue"],"sourcesContent":["import { Ref, ref } from 'vue'\r\nimport { RouteLocationNormalizedLoaded } from 'vue-router'\r\nimport { IResponseAttendance } from '@/features/reports'\r\nimport { useFetch, IError } from '@/shared'\r\nimport { store } from '@/store'\r\n\r\ninterface IParams {\r\n  route: RouteLocationNormalizedLoaded\r\n}\r\n\r\nconst useAttendance = ({ route }: IParams) => {\r\n  const attendance = ref<IResponseAttendance[] | null>(null)\r\n\r\n  const fetchAttendance = async (isValid: Ref<boolean>) => {\r\n    if (!isValid.value || !route.params.groupID) return\r\n    const { response, error } = await useFetch({\r\n      path: 'markMethods/attendance.getAttendanceListInfo',\r\n      data: {\r\n        groupID: route.params.groupID\r\n      }\r\n    })\r\n\r\n    if (error) {\r\n      console.log(error)\r\n      store.dispatch('setError', error as IError)\r\n    } else {\r\n      attendance.value = response.students as IResponseAttendance[]\r\n    }\r\n  }\r\n\r\n  const updateAttendance = (userID: number | string) => {\r\n    if (!attendance.value) return\r\n    attendance.value = attendance.value.map(user => {\r\n      if (user.userID === userID)\r\n        return { ...user, isPresent: !user.isPresent }\r\n      else\r\n        return { ...user }\r\n    })\r\n  }\r\n\r\n  return { attendance, fetchAttendance, updateAttendance }\r\n}\r\n\r\nexport default useAttendance\r\n","import { ref } from 'vue'\r\nimport { useFetch, IError } from \"@/shared\"\r\nimport { store } from \"@/store\"\r\nimport { IResponseAttendance } from \"@/features/reports\"\r\n\r\nconst useSaveReport = () => {\r\n  const markAttendance = async (present: IResponseAttendance[], groupID: number) => {\r\n    const usersIDs = present.map(s => s.userID)\r\n    if (!usersIDs.length) return\r\n\r\n    const { error } = await useFetch({\r\n      path: 'markMethods/attendance.markUserAttendance',\r\n      data: { groupID, usersIDs }\r\n    })\r\n\r\n    if (error) {\r\n      console.log(error)\r\n      store.dispatch('setError', error as IError)\r\n    }\r\n  }\r\n\r\n  const removeAttendance = async (missing: IResponseAttendance[], groupID: number) => {\r\n    const usersIDs = missing.map(s => s.userID)\r\n    if (!usersIDs.length) return\r\n\r\n    const { error } = await useFetch({\r\n      path: 'markMethods/attendance.removeUserAttendance',\r\n      data: { groupID, usersIDs }\r\n    })\r\n\r\n    if (error) {\r\n      console.log(error)\r\n      store.dispatch('setError', error as IError)\r\n    }\r\n  }\r\n\r\n  interface IParams {\r\n    attendance: IResponseAttendance[],\r\n    groupID: number\r\n  }\r\n\r\n  const saveCount = ref(0)\r\n\r\n  const saveReport = async ({ attendance, groupID }: IParams) => {\r\n    await markAttendance(attendance.filter(s => s.isPresent), groupID)\r\n    await removeAttendance(attendance.filter(s => !s.isPresent), groupID)\r\n    saveCount.value += 1\r\n  }\r\n\r\n  return { saveReport, saveCount }\r\n}\r\n\r\nexport default useSaveReport\r\n","import { ref } from 'vue'\r\nimport { store } from \"@/store\"\r\nimport { IError, useFetch } from \"@/shared\"\r\nimport { IResponseAttendance } from '@/features/reports'\r\nimport useSaveReport from './useSaveReport'\r\n\r\n/* eslint-disable */\r\nfunction makeid(length: number) {\r\n  var result           = '';\r\n  var characters       = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\r\n  var charactersLength = characters.length;\r\n  for ( var i = 0; i < length; i++ ) {\r\n    result += characters.charAt(Math.floor(Math.random() * \r\ncharactersLength));\r\n }\r\n return result;\r\n}\r\n/* eslint-enable */\r\n\r\nconst useCreateReport = () => {\r\n  interface IParams {\r\n    groupID: number,\r\n    usersIDs?: number[],\r\n    attendance: IResponseAttendance[]\r\n  }\r\n\r\n  const reportID = ref<string | null>(null)\r\n  const createAndSaveCount = ref(0)\r\n  const notSelectedCounter = ref(0)\r\n\r\n  const createReport = async (groupID: number, usersIDs: number[] | undefined) => {\r\n    /* eslint-disable */\r\n    if (store.getters.roles.includes('teacher')) {\r\n      if (store.state.userInfo?.id)\r\n        usersIDs = [store.state.userInfo.id]\r\n    } else {\r\n      if (!usersIDs || !usersIDs.length) {\r\n        notSelectedCounter.value += 1\r\n        return 'not selected'\r\n      }\r\n    }\r\n    /* eslint-enable */\r\n\r\n    const { response, error } = await useFetch({\r\n      path: 'markMethods/attendance.createAttendanceReport',\r\n      data: {\r\n        groupID, hash: makeid(30)\r\n      }\r\n    })\r\n\r\n    if (error) {\r\n      console.log(error)\r\n      store.dispatch('setError', error as IError)\r\n    } else {\r\n      reportID.value = response\r\n    }\r\n    return undefined\r\n  }\r\n\r\n  const { saveReport } = useSaveReport()\r\n\r\n  const createAndSendReport = async ({ groupID, usersIDs, attendance }: IParams) => {\r\n    await saveReport({ groupID, attendance })\r\n    const notSelected = await createReport(groupID, usersIDs)\r\n\r\n    if (store.getters.roles.includes('teacher')) {\r\n      if (store.state.userInfo?.id)\r\n        usersIDs = [store.state.userInfo.id] // eslint-disable-line\r\n    }\r\n\r\n    if (reportID.value && !notSelected) {\r\n      const { error } = await useFetch({\r\n        path: 'markMethods/attendance.sendAttendanceReport',\r\n        data: {\r\n          reportID: reportID.value,\r\n          hash: makeid(30),\r\n          usersIDs\r\n        }\r\n      })\r\n\r\n      if (error) {\r\n        console.log(error)\r\n        store.dispatch(error)\r\n      } else {\r\n        createAndSaveCount.value += 1\r\n      }\r\n    }\r\n  }\r\n\r\n  return { createAndSendReport, createAndSaveCount, notSelectedCounter }\r\n}\r\n\r\nexport default useCreateReport\r\n","import { ref } from 'vue'\r\nimport { Router, RouteLocationNormalizedLoaded } from 'vue-router'\r\nimport { store } from '@/store'\r\n\r\ninterface IParams {\r\n  router: Router,\r\n  route: RouteLocationNormalizedLoaded\r\n}\r\n\r\nconst useValidation = ({ router, route }: IParams) => {\r\n  const isValid = ref(false)\r\n\r\n  const pushToStartingRoute = () => {\r\n    if (\r\n      !store.getters.roles\r\n      || !store.state.userInfo\r\n      //|| !store.state.institution\r\n    ) return\r\n\r\n    const isHeadStudent = store.state.userInfo.institutionData.groupStatus === 'head_student'\r\n    const isDeputyStudent = store.state.userInfo.institutionData.groupStatus === 'deputy_head_student'\r\n    if (isHeadStudent || isDeputyStudent) {\r\n      if (store.state.userInfo.additionalData.inGroups[0])\r\n        router.push({ path: `/new-report/${store.state.userInfo.additionalData.inGroups[0]}` })\r\n      else\r\n        router.push({ path: '/notfound' })\r\n      return\r\n    }\r\n\r\n    const isTeacher = store.getters.roles.includes('teacher')\r\n    if (isTeacher) {\r\n      if (store.state.userInfo.additionalData.inGroups.length)\r\n        router.push({ path: `/new-report/${store.state.userInfo.additionalData.inGroups[0]}` })\r\n      else\r\n        router.push({ path: '/notfound' })\r\n      return\r\n    }\r\n\r\n    if (!store.state.institution) return\r\n    const isAdminUU = store.getters.roles.includes('administrator_of_institution')\r\n    if (isAdminUU) {\r\n      if (store.state.institution.groups[0])\r\n        router.push({ path: `/new-report/${store.state.institution.groups[0]}` })\r\n      else\r\n        router.push({ path: '/notfound' })\r\n      return\r\n    }\r\n\r\n    router.push({ path: '/notfound' })\r\n  }\r\n\r\n  const validate = () => {\r\n    if (\r\n      !store.getters.roles\r\n      || !store.state.userInfo\r\n      //|| !store.state.institution\r\n      || !route.path.startsWith('/new-report')\r\n    ) return\r\n\r\n    if (!route.params.groupID) {\r\n      console.log('push to starting route')\r\n      pushToStartingRoute()\r\n      return\r\n    }\r\n\r\n    const isHeadStudent = store.state.userInfo.institutionData.groupStatus === 'head_student'\r\n    const isDeputyStudent = store.state.userInfo.institutionData.groupStatus === 'deputy_head_student'\r\n    if (isHeadStudent || isDeputyStudent) {\r\n      const isExactGroup = store.state.userInfo.additionalData.inGroups[0] === +(route.params.groupID as string)\r\n      if (!isExactGroup) pushToStartingRoute()\r\n      else {\r\n        isValid.value = true\r\n        return\r\n      }\r\n    }\r\n\r\n    const isTeacher = store.getters.roles.includes('teacher')\r\n    if (isTeacher) {\r\n      const hasGroup = [\r\n        ...store.state.userInfo.additionalData.inGroups,\r\n        ...store.state.userInfo.additionalData.ownGroups\r\n      ].includes(+(route.params.groupID as string))\r\n      if (!hasGroup) pushToStartingRoute()\r\n      else {\r\n        isValid.value = true\r\n        return\r\n      }\r\n    }\r\n\r\n    if (!store.state.institution) return\r\n    const isAdminUU = store.getters.roles.includes('administrator_of_institution')\r\n    if (isAdminUU) {\r\n      const hasGroup = store.state.institution.groups.includes(+(route.params.groupID as string))\r\n      if (!hasGroup) pushToStartingRoute()\r\n      else {\r\n        isValid.value = true\r\n        return\r\n      }\r\n    }\r\n\r\n    // regular student\r\n    router.push({ path: '/notfound' })\r\n  }\r\n\r\n  const validationDeps = [\r\n    () => store.getters.roles,\r\n    () => store.state.userInfo,\r\n    () => store.state.institution,\r\n    () => route.params.groupID\r\n  ]\r\n\r\n  return { isValid, validate, validationDeps }\r\n}\r\n\r\nexport default useValidation\r\n","import { defineComponent as _defineComponent } from 'vue'\nimport { unref as _unref, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, Transition as _Transition, withCtx as _withCtx, Fragment as _Fragment, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\nimport _imports_0 from '@/assets/tabler-sprite.svg'\n\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-28f66bf4\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = _imports_0 + '#tabler-layout-sidebar-right'\nconst _hoisted_2 = {\n  key: 0,\n  class: \"no-students\"\n}\nconst _hoisted_3 = {\n  key: 1,\n  class: \"main --sidebar\"\n}\nconst _hoisted_4 = { class: \"sidebar --desktop\" }\nconst _hoisted_5 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", { class: \"separator\" }, null, -1))\nconst _hoisted_6 = {\n  key: 0,\n  class: \"group-title\"\n}\nconst _hoisted_7 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"svg\", {\n  width: \"24\",\n  height: \"24\",\n  viewBox: \"0 0 24 24\"\n}, [\n  /*#__PURE__*/_createElementVNode(\"use\", { href: _hoisted_1 })\n], -1))\nconst _hoisted_8 = [\n  _hoisted_7\n]\nconst _hoisted_9 = {\n  key: 0,\n  class: \"popup\"\n}\nconst _hoisted_10 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", { class: \"separator\" }, null, -1))\nconst _hoisted_11 = {\n  key: 0,\n  class: \"nav\"\n}\nconst _hoisted_12 = { class: \"main-single\" }\n\nimport {\r\n  onBeforeMount, watch, onMounted, ref, inject, computed\r\n} from 'vue'\r\nimport { useRoute, useRouter } from 'vue-router'\r\nimport { Key, IGroupInfo } from '@/store'\r\nimport { useStore } from 'vuex'\r\nimport { Alert } from '@/shared'\r\nimport { ReportUsers, TeachersSidebar } from '@/features/reports'\r\nimport {\r\n  useValidation, useAttendance, useSaveReport, useCreateReport\r\n} from './hooks'\r\n\r\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'NewReport',\n  setup(__props) {\n\r\nconst router = useRouter()\r\nconst route = useRoute()\r\n\r\nconst key = inject<Key>('key')\r\nconst { getters, state } = useStore(key)\r\n\r\nconst { validate, validationDeps, isValid } = useValidation({ route, router })\r\nonBeforeMount(validate)\r\nwatch(validationDeps, validate)\r\n\r\nonBeforeMount(() => document.title = 'Создать отчет')\r\n\r\nconst { attendance, fetchAttendance, updateAttendance } = useAttendance({ route })\r\nonMounted(() => fetchAttendance(isValid))\r\nwatch([\r\n  isValid,\r\n  () => route.params.groupID\r\n], () => fetchAttendance(isValid))\r\n\r\nconst groupInfo = ref<IGroupInfo | null>(null)\r\nconst headStudentID = ref<number | null>(null)\r\nconst deputyStudentID = ref<number | null>(null)\r\n\r\nwatch([isValid, () => route.params.groupID], () => {\r\n  const id = +(route.params.groupID as string)\r\n  if (!route.params.groupID) return\r\n  groupInfo.value = getters.getGroups(id)\r\n  if (groupInfo.value) {\r\n    headStudentID.value = groupInfo.value.headStudentID\r\n    deputyStudentID.value = groupInfo.value.deputyHeadStudentID\r\n  }\r\n})\r\n\r\nconst selectedIDs = ref<number[]>([])\r\nconst onTeacherSelect = (teacherID: number) => {\r\n  if (selectedIDs.value.includes(teacherID)) {\r\n    selectedIDs.value = selectedIDs.value.filter(id => id !== teacherID)\r\n  } else {\r\n    selectedIDs.value.push(teacherID)\r\n  }\r\n}\r\n\r\nconst { saveReport, saveCount } = useSaveReport()\r\nconst save = () => {\r\n  if (isValid && attendance.value) {\r\n    saveReport({\r\n      attendance: attendance.value,\r\n      groupID: +(route.params.groupID as string)\r\n    })\r\n  }\r\n}\r\n\r\nconst { createAndSendReport, createAndSaveCount, notSelectedCounter } = useCreateReport()\r\nconst sendReport = () => {\r\n  if (isValid && attendance.value) {\r\n    if (!getters.roles.includes('teacher')) {\r\n      createAndSendReport({\r\n        groupID: +(route.params.groupID as string),\r\n        usersIDs: selectedIDs.value,\r\n        attendance: attendance.value\r\n      })\r\n    } else {\r\n      createAndSendReport({\r\n        groupID: +(route.params.groupID as string),\r\n        attendance: attendance.value\r\n      })\r\n    }\r\n  }\r\n}\r\n\r\nconst opened = ref(false)\r\n\r\nconst checkStatus = (userID: number | string) => {\r\n  if (typeof userID === 'string') return undefined\r\n  if (userID === headStudentID.value) return 'Староста'\r\n  if (userID === deputyStudentID.value) return 'Зам. старосты'\r\n  return undefined\r\n}\r\n\r\nconst getTeachers = computed(() => {\r\n  if (!groupInfo.value) return []\r\n  //return groupInfo.value.users.teachers\r\n  if (Array.isArray(groupInfo.value.users.teachers))\r\n    return groupInfo.value.users.teachers\r\n  else\r\n    return Object.values(groupInfo.value.users.teachers)\r\n})\r\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(_Fragment, null, [\n    _createVNode(_unref(Alert), {\n      text: \"Учителя не выбраны!\",\n      observer: _unref(notSelectedCounter)\n    }, null, 8, [\"observer\"]),\n    _createVNode(_unref(Alert), {\n      text: \"Отчет сохранен и отправлен!\",\n      observer: _unref(createAndSaveCount)\n    }, null, 8, [\"observer\"]),\n    _createVNode(_unref(Alert), {\n      text: \"Посещаемость сохранена!\",\n      observer: _unref(saveCount)\n    }, null, 8, [\"observer\"]),\n    (_unref(attendance) && !_unref(attendance).length)\n      ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, \" В этой группе нет студентов \"))\n      : (_unref(attendance) && groupInfo.value)\n        ? (_openBlock(), _createElementBlock(\"main\", _hoisted_3, [\n            _createElementVNode(\"section\", _hoisted_4, [\n              _createVNode(_unref(TeachersSidebar), {\n                teacherIDs: _unref(getTeachers),\n                selectedIDs: selectedIDs.value,\n                onSelect: onTeacherSelect\n              }, null, 8, [\"teacherIDs\", \"selectedIDs\"]),\n              _hoisted_5,\n              _createElementVNode(\"button\", {\n                onClick: save,\n                class: \"button\"\n              }, \"Отметить\"),\n              _createElementVNode(\"button\", {\n                onClick: sendReport,\n                class: \"button\"\n              }, \"Отправить отчет\")\n            ]),\n            _createElementVNode(\"section\", null, [\n              (groupInfo.value.groupName)\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [\n                    _createElementVNode(\"h3\", null, _toDisplayString(groupInfo.value.groupName), 1),\n                    _createElementVNode(\"button\", {\n                      class: \"mobile-sidebar-button\",\n                      onClick: _cache[0] || (_cache[0] = ($event: any) => (opened.value = !opened.value))\n                    }, _hoisted_8),\n                    _createVNode(_Transition, { name: \"mobile-sidebar-animation\" }, {\n                      default: _withCtx(() => [\n                        (opened.value)\n                          ? (_openBlock(), _createElementBlock(\"section\", _hoisted_9, [\n                              _createVNode(_unref(TeachersSidebar), {\n                                teacherIDs: _unref(getTeachers),\n                                selectedIDs: selectedIDs.value,\n                                onSelect: onTeacherSelect\n                              }, null, 8, [\"teacherIDs\", \"selectedIDs\"]),\n                              _hoisted_10,\n                              _createElementVNode(\"button\", {\n                                onClick: save,\n                                class: \"button\"\n                              }, \"Отметить\"),\n                              _createElementVNode(\"button\", {\n                                onClick: sendReport,\n                                class: \"button\"\n                              }, \"Отправить отчет\")\n                            ]))\n                          : _createCommentVNode(\"\", true)\n                      ]),\n                      _: 1\n                    }),\n                    _createVNode(_Transition, { name: \"mobile-backdrop-animation\" }, {\n                      default: _withCtx(() => [\n                        (opened.value)\n                          ? (_openBlock(), _createElementBlock(\"div\", {\n                              key: 0,\n                              class: \"backdrop\",\n                              onClick: _cache[1] || (_cache[1] = ($event: any) => (opened.value = !opened.value))\n                            }))\n                          : _createCommentVNode(\"\", true)\n                      ]),\n                      _: 1\n                    })\n                  ]))\n                : _createCommentVNode(\"\", true),\n              _createVNode(_unref(ReportUsers), {\n                \"users-data\": _unref(attendance),\n                onEdit: _unref(updateAttendance),\n                \"check-status\": checkStatus\n              }, null, 8, [\"users-data\", \"onEdit\"])\n            ])\n          ]))\n        : (_unref(attendance))\n          ? (_openBlock(), _createElementBlock(_Fragment, { key: 2 }, [\n              (groupInfo.value)\n                ? (_openBlock(), _createElementBlock(\"nav\", _hoisted_11, [\n                    _createElementVNode(\"h1\", null, _toDisplayString(groupInfo.value.groupName), 1)\n                  ]))\n                : _createCommentVNode(\"\", true),\n              _createElementVNode(\"main\", _hoisted_12, [\n                _createVNode(_unref(ReportUsers), {\n                  \"users-data\": _unref(attendance),\n                  onEdit: _unref(updateAttendance),\n                  \"check-status\": checkStatus\n                }, null, 8, [\"users-data\", \"onEdit\"]),\n                _createElementVNode(\"button\", {\n                  onClick: save,\n                  class: \"button --mt\"\n                }, \"Отметить\"),\n                _createElementVNode(\"button\", {\n                  onClick: sendReport,\n                  class: \"button\"\n                }, \"Отправить отчет\")\n              ])\n            ], 64))\n          : _createCommentVNode(\"\", true)\n  ], 64))\n}\n}\n\n})","import script from \"./NewReport.vue?vue&type=script&lang=ts&setup=true\"\nexport * from \"./NewReport.vue?vue&type=script&lang=ts&setup=true\"\n\nimport \"./NewReport.vue?vue&type=style&index=0&id=28f66bf4&lang=scss&scoped=true\"\n\nimport exportComponent from \"G:\\\\Programming\\\\Apps\\\\mark\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-28f66bf4\"]])\n\nexport default __exports__"],"names":["useAttendance","route","attendance","ref","fetchAttendance","async","isValid","value","params","groupID","response","error","useFetch","path","data","console","log","store","students","updateAttendance","userID","map","user","isPresent","useSaveReport","markAttendance","present","usersIDs","s","length","removeAttendance","missing","saveCount","saveReport","filter","makeid","result","characters","charactersLength","i","charAt","Math","floor","random","useCreateReport","reportID","createAndSaveCount","notSelectedCounter","createReport","id","hash","createAndSendReport","notSelected","useValidation","router","pushToStartingRoute","isHeadStudent","isDeputyStudent","push","isTeacher","isAdminUU","validate","startsWith","isExactGroup","hasGroup","includes","validationDeps","_withScopeId","n","_pushScopeId","_popScopeId","_hoisted_1","_imports_0","_hoisted_2","key","class","_hoisted_3","_hoisted_4","_hoisted_5","_createElementVNode","_hoisted_6","_hoisted_7","width","height","viewBox","href","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_defineComponent","__name","setup","__props","useRouter","useRoute","inject","getters","state","useStore","onBeforeMount","watch","document","title","onMounted","groupInfo","headStudentID","deputyStudentID","getGroups","deputyHeadStudentID","selectedIDs","onTeacherSelect","teacherID","save","sendReport","roles","opened","checkStatus","getTeachers","computed","Array","isArray","users","teachers","Object","values","_ctx","_cache","_openBlock","_createElementBlock","_Fragment","_createVNode","_unref","Alert","text","observer","TeachersSidebar","teacherIDs","onSelect","onClick","groupName","_toDisplayString","$event","_Transition","name","default","_withCtx","_createCommentVNode","_","ReportUsers","onEdit","__exports__"],"sourceRoot":""}