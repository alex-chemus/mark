"use strict";(self["webpackChunkmark"]=self["webpackChunkmark"]||[]).push([[40],{40:function(e,t,a){a.r(t),a.d(t,{default:function(){return eu}});var u=a(252),o=a(262),s=a(907),n=a(562),r=a(201),l=a(235);const i={class:"wrapper"};var p=(0,u.aZ)({__name:"SearchGroups",props:{groups:null},emits:["search"],setup(e,{emit:t}){const a=e,o=e=>{const{value:u}=e.target;if(null===a.groups)return;""===u&&t("search",[]);const o=a.groups.filter((e=>{const t=new RegExp(u.toLowerCase().trim());return t.test(e.groupName.toLowerCase().trim())})).map((e=>e.groupID));t("search",o)};return(e,t)=>((0,u.wg)(),(0,u.iD)("div",i,[(0,u._)("input",{type:"text",onInput:o,placeholder:"Поиск"},null,32)]))}}),d=a(744);const c=(0,d.Z)(p,[["__scopeId","data-v-361360a4"]]);var g=c,v=a(577),h=a(963),D=a(933);const m=()=>{const e=(0,o.iH)(""),t=(0,o.iH)(!1),a=(0,o.iH)(!1),u=async()=>{if(!D.h.state.userInfo)return;const{response:u}=await(0,l.ib)({path:"markMethods/group.create",data:{groupName:e.value,enableRoles:t.value}});if(a.value&&D.h.getters.roles.includes("teacher")){const{error:e}=await(0,l.ib)({path:"markMethods/group.transferToInstitution",data:{groupID:u,institutionID:D.h.getters.IID,leaveGroup:0}});e&&(D.h.dispatch("setError",e),console.log(e))}};return{name:e,hasRoles:t,createGroup:u,shouldAttach:a}};var I=m;const _=e=>((0,u.dD)("data-v-5c328140"),e=e(),(0,u.Cn)(),e),b={for:"name"},f=_((()=>(0,u._)("span",null,"Название группы",-1))),w={key:0},k={class:"button-wrapper"},y=["onClick"];var S=(0,u.aZ)({__name:"CreateGroup",emits:["toggle"],setup(e,{emit:t}){const a=(0,u.f3)("key"),{getters:n,dispatch:r,state:i}=(0,s.oR)(a),{name:p,hasRoles:d,createGroup:c,shouldAttach:g}=I(),v=async()=>{await c(),t("toggle"),n.roles.includes("administrator_of_institution")?await r("fetchInstituion"):await r("fetchUserInfo"),r("useGroups")};return(e,a)=>((0,u.wg)(),(0,u.iD)(u.HY,null,[(0,u._)("form",{class:"create-section",onSubmit:a[4]||(a[4]=(0,h.iM)((()=>{}),["prevent"]))},[(0,u._)("label",b,[f,(0,u.wy)((0,u._)("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=e=>(0,o.dq)(p)?p.value=e:null),id:"name"},null,512),[[h.nr,(0,o.SU)(p)]])]),(0,u._)("div",null,[(0,u.Wm)((0,o.SU)(l.XZ),{title:"Роли в группе",state:(0,o.SU)(d),onToggle:a[1]||(a[1]=e=>d.value=!(0,o.SU)(d))},null,8,["state"])]),(0,o.SU)(n).roles.includes("teacher")&&(0,o.SU)(i).userInfo?.institutionData.institutionID?((0,u.wg)(),(0,u.iD)("div",w,[(0,u.Wm)((0,o.SU)(l.XZ),{title:"Привязать к учреждению",state:(0,o.SU)(g),onToggle:a[2]||(a[2]=e=>g.value=!(0,o.SU)(g))},null,8,["state"])])):(0,u.kq)("",!0),(0,u._)("div",k,[(0,u._)("button",{class:"cancel-button",onClick:a[3]||(a[3]=(0,h.iM)((e=>t("toggle")),["prevent"]))},"Отмена"),(0,u._)("button",{class:"create-button",onClick:(0,h.iM)(v,["prevent"])},"Создать",8,y)])],32),(0,u._)("div",{class:"backdrop",onClick:a[5]||(a[5]=e=>t("toggle"))})],64))}});const U=(0,d.Z)(S,[["__scopeId","data-v-5c328140"]]);var C=U;const H=e=>((0,u.dD)("data-v-58d76176"),e=e(),(0,u.Cn)(),e),G=n+"#tabler-plus",Z={class:"wrapper"},x={class:"group-name"},N=H((()=>(0,u._)("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},[(0,u._)("use",{href:G})],-1))),W=[N];var q=(0,u.aZ)({__name:"GroupControls",setup(e){const t=(0,u.f3)("key"),{getters:a}=(0,s.oR)(t),n=(0,o.iH)(!1),r=(0,u.Fl)((()=>a.roles.includes("administrator_of_institution")?"Созданные":"Мои группы"));return(e,t)=>((0,u.wg)(),(0,u.iD)("div",Z,[(0,u._)("h2",x,(0,v.zw)((0,o.SU)(r)),1),(0,u._)("button",{class:"add-button",onClick:t[0]||(t[0]=e=>n.value=!0)},W),n.value?((0,u.wg)(),(0,u.j4)(C,{key:0,onToggle:t[1]||(t[1]=e=>n.value=!n.value)})):(0,u.kq)("",!0)]))}});const R=(0,d.Z)(q,[["__scopeId","data-v-58d76176"]]);var F=R;const T={class:"groups-list"},j=["onClick"];var Y=(0,u.aZ)({__name:"GroupsList",props:{groups:null,currentGroup:null},emits:["switch"],setup(e,{emit:t}){const a=e,o=e=>a.currentGroup===e?"selected":"";return(a,s)=>((0,u.wg)(),(0,u.iD)("ul",T,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(e.groups,(e=>((0,u.wg)(),(0,u.iD)("li",{key:e.groupID,class:(0,v.C_)(o(e.groupID))},[(0,u._)("button",{onClick:a=>t("switch",e.groupID)},(0,v.zw)(e.groupName),9,j)],2)))),128))]))}});const B=(0,d.Z)(Y,[["__scopeId","data-v-5d2f480b"]]);var $=B;const M={class:"groups-sidebar"},A={class:"controls-wrapper"};var L=(0,u.aZ)({__name:"GroupsSidebar",props:{groupsIDs:null,currentGroup:null},emits:["change-group"],setup(e,{emit:t}){const a=e,n=(0,u.f3)("key"),{state:r,getters:l}=(0,s.oR)(n),i=(0,o.iH)(null),p=()=>{r.groups&&a.groupsIDs&&(i.value=l.getGroups(a.groupsIDs))};(0,u.YP)([()=>r.groups,()=>a.groupsIDs],p),(0,u.bv)(p);const d=(0,o.iH)(null),c=(0,u.Fl)((()=>i.value?d.value?i.value.filter((e=>d.value?.includes(e.groupID))):i.value:[]));return(a,s)=>((0,u.wg)(),(0,u.iD)("aside",M,[(0,u.Wm)(g,{groups:i.value,onSearch:s[0]||(s[0]=e=>d.value=e)},null,8,["groups"]),(0,u._)("div",A,[(0,u.Wm)(F)]),(0,u.Wm)($,{groups:(0,o.SU)(c),"current-group":e.currentGroup,onSwitch:s[1]||(s[1]=e=>t("change-group",e))},null,8,["groups","current-group"])]))}});const P=(0,d.Z)(L,[["__scopeId","data-v-19639a38"]]);var E=P;const z=()=>{const e=(0,o.iH)(null),t=(0,o.iH)(""),a=async({groupID:a,url:u})=>{const{response:o,error:s}=await(0,l.ib)({path:"markMethods/group.createInvitation",data:{groupID:a}});return s?(D.h.dispatch("setError",s),console.log(s),null):(e.value=`${u}/invitation/${o}`,navigator.clipboard.writeText(e.value),t.value="Ссылка скопирована!",e.value)};return{shareGroup:a,message:t,invitationLink:e}};var O=z;const K=e=>((0,u.dD)("data-v-ddf028b4"),e=e(),(0,u.Cn)(),e),V=n+"#tabler-alert-triangle",X={key:0,class:"leave-warning"},J=K((()=>(0,u._)("svg",{width:"40",height:"40",viewBox:"0 0 40 40"},[(0,u._)("use",{href:V})],-1))),Q=K((()=>(0,u._)("p",null,"Вы уверены, что хотите покинуть гурппу?",-1))),ee={class:"button-wrapper"};var te=(0,u.aZ)({__name:"LeaveWarning",props:{isOpen:{type:Boolean}},emits:["close"],setup(e,{emit:t}){const a=(0,u.f3)("key"),{dispatch:o,state:n}=(0,s.oR)(a),r=async()=>{n.userInfo&&n.userInfo.additionalData.inGroups.length&&(await(0,l.ib)({path:"markMethods/group.leave",data:{groupID:n.userInfo.additionalData.inGroups[0]}}),await o("fetchUserInfo"),t("close"))};return(a,o)=>((0,u.wg)(),(0,u.iD)(u.HY,null,[e.isOpen?((0,u.wg)(),(0,u.iD)("section",X,[J,Q,(0,u._)("div",ee,[(0,u._)("button",{class:"button-hollow",onClick:r},"Покинуть"),(0,u._)("button",{class:"button-fill",onClick:o[0]||(o[0]=e=>t("close"))},"Остаться")])])):(0,u.kq)("",!0),e.isOpen?((0,u.wg)(),(0,u.iD)("div",{key:1,class:"backdrop",onClick:o[1]||(o[1]=e=>t("close"))})):(0,u.kq)("",!0)],64))}});const ae=(0,d.Z)(te,[["__scopeId","data-v-ddf028b4"]]);var ue=ae;const oe=e=>((0,u.dD)("data-v-1ef1df80"),e=e(),(0,u.Cn)(),e),se=n+"#tabler-share",ne=n+"#tabler-logout",re={class:"group-popup"},le={class:"mobile-group"},ie=oe((()=>(0,u._)("svg",{width:"22",height:"22",viewBox:"0 0 22 22"},[(0,u._)("use",{href:se})],-1))),pe=[ie],de={class:"list"},ce={key:0},ge={key:1},ve={key:2},he={key:3},De={key:4},me={key:5},Ie=oe((()=>(0,u._)("svg",{width:"22",height:"22",viewBox:"0 0 22 22"},[(0,u._)("use",{href:ne})],-1))),_e=oe((()=>(0,u._)("span",null,"Выйти из группы",-1))),be=[Ie,_e];var fe=(0,u.aZ)({__name:"GroupPopup",props:{opened:{type:Boolean},groupInfo:null},emits:["toggle"],setup(e,{emit:t}){const a=e,n=(0,u.f3)("key"),{getters:r,state:i}=(0,s.oR)(n),{message:p,shareGroup:d,invitationLink:c}=O(),g=()=>d({groupID:a.groupInfo.groupID,url:location.origin}),D=(0,u.Fl)((()=>i.institution?.shortName)),m=(0,u.Fl)((()=>{const e=a.groupInfo.additionalData.facultyID;return i.institution?i.institution.additionalData.faculties.find((t=>t.facultyID===e)):null})),I=(0,u.Fl)((()=>{const e=a.groupInfo.additionalData.departmentID;return m.value?m.value.departments.find((t=>t.departmentID===e)):null})),_=(0,o.iH)(!1),b=(0,u.Fl)((()=>r.roles.includes("teacher")||r.roles.includes("administrator_of_institution"))),f=(0,u.Fl)((()=>!r.roles.includes("teacher")&&!r.roles.includes("administrator_of_institution")));return(a,s)=>((0,u.wg)(),(0,u.iD)(u.HY,null,[(0,u.Wm)(h.uT,{name:"group-popup-animation"},{default:(0,u.w5)((()=>[(0,u.wy)((0,u._)("section",re,[(0,u._)("div",le,[(0,u._)("h6",null,(0,v.zw)(e.groupInfo.groupName),1),(0,o.SU)(b)?((0,u.wg)(),(0,u.iD)("button",{key:0,class:"share-button",onClick:g},pe)):(0,u.kq)("",!0),(0,u.Wm)((0,o.SU)(l.bZ),{text:(0,o.SU)(p),observer:(0,o.SU)(c)},null,8,["text","observer"])]),(0,u._)("dl",de,[(0,o.SU)(D)?((0,u.wg)(),(0,u.iD)("dt",ce,(0,v.zw)((0,o.SU)(D)),1)):(0,u.kq)("",!0),(0,o.SU)(D)?((0,u.wg)(),(0,u.iD)("dd",ge,"Учебное учреждение")):(0,u.kq)("",!0),(0,o.SU)(m)?((0,u.wg)(),(0,u.iD)("dt",ve,(0,v.zw)((0,o.SU)(m)),1)):(0,u.kq)("",!0),(0,o.SU)(m)?((0,u.wg)(),(0,u.iD)("dd",he,"Специальность")):(0,u.kq)("",!0),(0,o.SU)(I)?((0,u.wg)(),(0,u.iD)("dt",De,(0,v.zw)((0,o.SU)(I)),1)):(0,u.kq)("",!0),(0,o.SU)(I)?((0,u.wg)(),(0,u.iD)("dd",me,"Факультет")):(0,u.kq)("",!0)]),(0,o.SU)(f)?((0,u.wg)(),(0,u.iD)("button",{key:0,class:"logout-btn",onClick:s[0]||(s[0]=e=>_.value=!0)},be)):(0,u.kq)("",!0)],512),[[h.F8,e.opened]])])),_:1}),(0,u.Wm)(h.uT,{name:"group-backdrop-animation"},{default:(0,u.w5)((()=>[(0,u.wy)((0,u._)("div",{class:"backdrop",onClick:s[1]||(s[1]=e=>t("toggle"))},null,512),[[h.F8,e.opened]])])),_:1}),(0,u.Wm)(ue,{"is-open":_.value,onClose:s[2]||(s[2]=e=>_.value=!1)},null,8,["is-open"])],64))}});const we=(0,d.Z)(fe,[["__scopeId","data-v-1ef1df80"]]);var ke=we;const ye=e=>((0,u.dD)("data-v-61635021"),e=e(),(0,u.Cn)(),e),Se=n+"#tabler-dots-vertical",Ue={class:"user"},Ce=ye((()=>(0,u._)("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},[(0,u._)("use",{href:Se})],-1))),He=[Ce],Ge={class:"options"};var Ze=(0,u.aZ)({__name:"GroupUser",props:{headStudentID:null,deputyHeadStudentID:null,groupID:null,avatar:null,fullName:null,uid:null},setup(e){const t=e,a=(0,u.f3)("key"),{dispatch:n}=(0,s.oR)(a),r=(0,o.iH)(!1),i=async(e,a)=>{const{error:u}=await(0,l.ib)({path:"markMethods/group.setUserStatus",data:{groupID:t.groupID,userID:a,status:e}});u?(n("setError",u),console.log(u)):(n("useGroups"),r.value=!1)},p=e=>t.headStudentID===+e?"Староста":t.deputyHeadStudentID===+e?"Зам. старосты":"";return(t,a)=>((0,u.wg)(),(0,u.iD)("li",Ue,[(0,u.Wm)((0,o.SU)(l.n5),{avatar:e.avatar,"full-name":e.fullName,uid:e.uid,"badge-text":p(e.uid)},null,8,["avatar","full-name","uid","badge-text"]),(0,u._)("button",{class:"more-button",onClick:a[0]||(a[0]=e=>r.value=!r.value)},He),(0,u.wy)((0,u._)("ul",Ge,[(0,u._)("li",null,[(0,u._)("button",{class:"option-button",onClick:a[1]||(a[1]=t=>i(3,e.uid))}," Сделать старостой ")]),(0,u._)("li",null,[(0,u._)("button",{class:"option-button",onClick:a[2]||(a[2]=t=>i(2,e.uid))}," Сделать заместителем старосты ")])],512),[[h.F8,r.value]]),r.value?((0,u.wg)(),(0,u.iD)("div",{key:0,class:"backdrop",onClick:a[3]||(a[3]=e=>r.value=!r.value),onKeydown:a[4]||(a[4]=(0,h.D2)((e=>r.value=!r.value),["esc"]))},null,32)):(0,u.kq)("",!0)]))}});const xe=(0,d.Z)(Ze,[["__scopeId","data-v-61635021"]]);var Ne=xe;const We={key:0,class:"users-list"};var qe=(0,u.aZ)({__name:"GroupUsers",props:{users:null,headStudentID:null,deputyHeadStudentID:null,groupID:null},setup(e){const t=e,{users:a,fetchUsers:s}=(0,l.TL)();(0,u.bv)((()=>{t.users&&0!==t.users.length&&(Array.isArray(t.users)?s({userIds:t.users.join(", ")}):s({userIds:Object.values(t.users).join(", ")}))})),(0,u.YP)((()=>t.users),(()=>{t.users&&(0===t.users.length?a.value=[]:Array.isArray(t.users)?s({userIds:t.users.join(", ")}):s({userIds:Object.values(t.users).join(", ")}))}));const n=(0,u.Fl)((()=>{if(null===a.value)return null;function e(e,t){return e.fullName<t.fullName?-1:e.fullName>t.fullName?1:0}return[...a.value].sort(e)}));return(t,s)=>(0,o.SU)(a)&&(0,o.SU)(a).length>0?((0,u.wg)(),(0,u.iD)("ul",We,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)((0,o.SU)(n),(t=>((0,u.wg)(),(0,u.j4)(Ne,{key:t.uid,headStudentID:e.headStudentID,deputyHeadStudentID:e.deputyHeadStudentID,groupID:e.groupID,avatar:t.avatar,"full-name":t.fullName,uid:t.uid},null,8,["headStudentID","deputyHeadStudentID","groupID","avatar","full-name","uid"])))),128))])):(0,u.kq)("",!0)}});const Re=(0,d.Z)(qe,[["__scopeId","data-v-5d264a4c"]]);var Fe=Re;const Te=e=>((0,u.dD)("data-v-770b9665"),e=e(),(0,u.Cn)(),e),je=n+"#tabler-layout-sidebar-right",Ye=n+"#tabler-share",Be=n+"#tabler-dots-vertical",$e={class:"admin-group-nav"},Me={class:"control-group"},Ae=Te((()=>(0,u._)("svg",{width:"22",height:"22",viewBox:"0 0 22 22"},[(0,u._)("use",{href:je})],-1))),Le=[Ae],Pe=Te((()=>(0,u._)("svg",{width:"22",height:"22",viewBox:"0 0 22 22"},[(0,u._)("use",{href:Ye})],-1))),Ee=[Pe],ze=Te((()=>(0,u._)("svg",{width:"22",height:"22",viewBox:"0 0 22 22"},[(0,u._)("use",{href:Be})],-1))),Oe=[ze],Ke={class:"sidebar-popup"};var Ve=(0,u.aZ)({__name:"AdminGroupNav",props:{groupNavItem:null,groupInfo:null,groupsList:null,currentGroup:null},emits:["switch","change-group"],setup(e,{emit:t}){const a=e,{message:s,shareGroup:n,invitationLink:r}=O(),i=()=>n({groupID:a.groupInfo.groupID,url:location.origin}),p=(0,o.iH)(!1),d=(0,o.iH)(!1),c=e=>e===a.groupNavItem?"selected":"";return(a,n)=>((0,u.wg)(),(0,u.iD)("nav",$e,[(0,u._)("ul",null,[(0,u._)("li",{class:(0,v.C_)(c("Студенты"))},[(0,u._)("button",{onClick:n[0]||(n[0]=e=>t("switch","Студенты")),class:"nav-button"},"Студенты")],2),(0,u._)("li",{class:(0,v.C_)(c("Преподаватели"))},[(0,u._)("button",{onClick:n[1]||(n[1]=e=>t("switch","Преподаватели")),class:"nav-button"},"Преподаватели")],2)]),(0,u._)("div",Me,[(0,u._)("button",{class:"sidebar-button button",onClick:n[2]||(n[2]=e=>d.value=!0)},Le),(0,u._)("button",{class:"share-button button",onClick:i},Ee),(0,u._)("button",{class:"popup-button button",onClick:n[3]||(n[3]=e=>p.value=!p.value)},Oe),(0,u.Wm)((0,o.SU)(ke),{opened:p.value,"group-info":e.groupInfo,onToggle:n[4]||(n[4]=e=>p.value=!p.value)},null,8,["opened","group-info"]),(0,u.Wm)((0,o.SU)(l.bZ),{text:(0,o.SU)(s),observer:(0,o.SU)(r)},null,8,["text","observer"])]),(0,u.Wm)(h.uT,{name:"mobile-sidebar-animation"},{default:(0,u.w5)((()=>[(0,u.wy)((0,u._)("div",Ke,[e.groupsList?((0,u.wg)(),(0,u.j4)((0,o.SU)(E),{key:0,groupsIDs:e.groupsList,"current-group":e.currentGroup,onChangeGroup:n[5]||(n[5]=e=>t("change-group",e))},null,8,["groupsIDs","current-group"])):(0,u.kq)("",!0)],512),[[h.F8,d.value]])])),_:1}),(0,u.Wm)(h.uT,{name:"mobile-backdrop-animation"},{default:(0,u.w5)((()=>[(0,u.wy)((0,u._)("div",{class:"sidebar-backdrop",onClick:n[6]||(n[6]=e=>d.value=!d.value)},null,512),[[h.F8,d.value]])])),_:1})]))}});const Xe=(0,d.Z)(Ve,[["__scopeId","data-v-770b9665"]]);var Je=Xe;const Qe=()=>{const e=(0,o.iH)(null),t=async({group:t})=>{if(!e.value||0===e.value.length)return;const a=e.value.filter((e=>e.selected)).map((e=>e.uid)).join(", "),{response:u,error:o}=await(0,l.ib)({path:"markMethods/group.addTeachers",data:{teachersIDs:a,groupID:t}});return o?(D.h.dispatch("setError",o),console.log(o),null):u};return{teachersList:e,addTeachers:t}};var et=Qe;const tt={key:0,class:"button-wrapper"},at={class:"add-modal"},ut={class:"button-wrapper"};var ot=(0,u.aZ)({__name:"AddTeacher",props:{group:null,groupInfo:null},emits:["add"],setup(e,{emit:t}){const a=e,n=(0,u.f3)("key"),{state:r,dispatch:i}=(0,s.oR)(n),{users:p,fetchUsers:d}=(0,l.TL)(),c=async()=>{if(r.institution){const e=r.institution.additionalData.staff.teachers.map((e=>e.userID)).join(", "),{teachers:t}=a.groupInfo.users;Array.isArray(t)?d({userIds:e,excludeIds:t}):d({userIds:e,excludeIds:Object.values(t)})}};(0,u.bv)(c),(0,u.YP)((()=>a.groupInfo),c);const{teachersList:g,addTeachers:v}=et();(0,u.YP)(p,(()=>{if(!p.value)return null;g.value=p.value.map((e=>({...e,selected:!1})))}));const D=(0,o.iH)(!1),m=async()=>{await v({group:a.group}),i("useGroups"),D.value=!1};return(e,t)=>((0,u.wg)(),(0,u.iD)(u.HY,null,[(0,o.SU)(g)&&(0,o.SU)(g).length?((0,u.wg)(),(0,u.iD)("div",tt,[(0,u._)("button",{class:"add-button",onClick:t[0]||(t[0]=e=>D.value=!0)},"Добавить")])):(0,u.kq)("",!0),(0,u.wy)((0,u._)("section",at,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)((0,o.SU)(g),(e=>((0,u.wg)(),(0,u.iD)("div",{key:e.uid,class:"teacher-wrapper"},[(0,u.Wm)((0,o.SU)(l.n5),{avatar:e.avatar,"full-name":e.fullName,"hide-on-shrink":!0},null,8,["avatar","full-name"]),(0,u.Wm)((0,o.SU)(l.XZ),{state:e.selected,onToggle:t=>e.selected=!e.selected},null,8,["state","onToggle"])])))),128)),(0,u._)("div",ut,[(0,u._)("button",{class:"cancel-button",onClick:t[1]||(t[1]=e=>D.value=!1)},"Отмена"),(0,u._)("button",{class:"fetch-button",onClick:m},"Добавить")])],512),[[h.F8,D.value]]),(0,u.wy)((0,u._)("div",{class:"backdrop",onClick:t[2]||(t[2]=e=>D.value=!1)},null,512),[[h.F8,D.value]])],64))}});const st=(0,d.Z)(ot,[["__scopeId","data-v-6ba1a830"]]);var nt=st;const rt=e=>((0,u.dD)("data-v-d17490e0"),e=e(),(0,u.Cn)(),e),lt=n+"#tabler-list-check",it={class:"admin-groups"},pt={class:"desktop-sidebar"},dt={key:0,class:"main"},ct={key:0,class:"attendance"},gt=rt((()=>(0,u._)("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},[(0,u._)("use",{href:lt})],-1))),vt=rt((()=>(0,u._)("span",null,"Посещаемость",-1))),ht=[gt,vt],Dt={key:2};var mt=(0,u.aZ)({__name:"AdminGroups",setup(e){const t=(0,u.f3)("key"),{state:a,getters:n}=(0,s.oR)(t),i=(0,r.yj)(),p=(0,r.tv)(),d=(0,o.iH)("Студенты"),c=(0,o.iH)(null),g=()=>{if(("/"===i.path||i.path.startsWith("/groupID"))&&a.institution?.groups){const e=+i.params.groupID;i.params.groupID&&a.institution.groups.includes(e)?c.value=e:p.push({path:`/groupID/${a.institution.groups[0]}`})}};(0,u.bv)(g),(0,u.YP)([()=>a.institution,()=>i.params.groupID],g);const v=(0,o.iH)(null);return(0,u.YP)([()=>a.groups,c],(()=>v.value=n.getGroups(c.value))),(e,t)=>((0,u.wg)(),(0,u.iD)("main",it,[(0,u._)("div",pt,[(0,o.SU)(a).institution?.groups?((0,u.wg)(),(0,u.j4)((0,o.SU)(E),{key:0,groupsIDs:(0,o.SU)(a).institution.groups,currentGroup:c.value,onChangeGroup:t[0]||(t[0]=e=>(0,o.SU)(p).push({path:`/groupID/${e}`}))},null,8,["groupsIDs","currentGroup"])):(0,u.kq)("",!0)]),v.value?((0,u.wg)(),(0,u.iD)("section",dt,[(0,u.Wm)(Je,{"group-info":v.value,"group-nav-item":d.value,"groups-list":(0,o.SU)(a).institution?.groups,"current-group":c.value,onSwitch:t[1]||(t[1]=e=>d.value=e),onChangeGroup:t[2]||(t[2]=e=>(0,o.SU)(p).push({path:`/groupID/${e}`}))},null,8,["group-info","group-nav-item","groups-list","current-group"]),"Студенты"===d.value?((0,u.wg)(),(0,u.iD)("section",ct,[(0,u._)("button",{onClick:t[3]||(t[3]=e=>(0,o.SU)(p).push({path:`/attendance/group/${v.value.groupID}`}))},ht)])):(0,u.kq)("",!0),"Студенты"===d.value&&c.value?((0,u.wg)(),(0,u.j4)((0,o.SU)(Fe),{key:1,users:v.value.users.students,headStudentID:v.value.headStudentID,deputyHeadStudentID:v.value.deputyHeadStudentID,groupID:v.value.groupID},null,8,["users","headStudentID","deputyHeadStudentID","groupID"])):"Преподаватели"===d.value&&c.value?((0,u.wg)(),(0,u.iD)("div",Dt,[(0,u.Wm)((0,o.SU)(l.to),{users:v.value.users.teachers},null,8,["users"]),(0,u.Wm)(nt,{group:c.value,"group-info":v.value},null,8,["group","group-info"])])):(0,u.kq)("",!0)])):(0,u.kq)("",!0)]))}});const It=(0,d.Z)(mt,[["__scopeId","data-v-d17490e0"]]);var _t=It;const bt=e=>((0,u.dD)("data-v-30551bd2"),e=e(),(0,u.Cn)(),e),ft=n+"#tabler-layout-sidebar",wt=n+"#tabler-share",kt=n+"#tabler-info-circle",yt=n+"#tabler-file-description",St={key:0,class:"no-groups"},Ut={key:1,class:"teacher-groups"},Ct={class:"desktop-sidebar"},Ht={key:0,class:"main"},Gt={class:"title-group"},Zt=bt((()=>(0,u._)("svg",{width:"22",height:"22",viewBox:"0 0 22 22"},[(0,u._)("use",{href:ft})],-1))),xt=[Zt],Nt={class:"group-title"},Wt=bt((()=>(0,u._)("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},[(0,u._)("use",{href:wt})],-1))),qt=[Wt],Rt=bt((()=>(0,u._)("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},[(0,u._)("use",{href:kt})],-1))),Ft=[Rt],Tt={class:"sidebar-popup"},jt={class:"attendance"},Yt=bt((()=>(0,u._)("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},[(0,u._)("use",{href:yt})],-1))),Bt=bt((()=>(0,u._)("span",null,"Создать отчет посещаемости",-1))),$t=[Yt,Bt];var Mt=(0,u.aZ)({__name:"TeacherGroups",setup(e){const t=(0,u.f3)("key"),{state:a,dispatch:n,getters:i}=(0,s.oR)(t),p=(0,r.yj)(),d=(0,r.tv)(),c=(0,o.iH)([]),g=(0,o.iH)(0),D=(0,o.iH)(!1),m=()=>{if("/"!==p.path&&!p.path.startsWith("/groupID"))return;if(!a.userInfo)return;if(c.value=[...a.userInfo.additionalData.inGroups,...a.userInfo.additionalData.ownGroups],0===c.value.length)return void(D.value=!0);const e=+p.params.groupID;p.params.groupID&&c.value.includes(e)?g.value=+p.params.groupID:d.push({path:`/groupID/${c.value[0]}`})};(0,u.YP)([()=>a.userInfo,()=>p.params.groupID],m),(0,u.wF)(m);const I=(0,o.iH)(null);(0,u.YP)([()=>a.groups,g],(()=>I.value=i.getGroups(g.value)));const{message:_,shareGroup:b,invitationLink:f}=O(),w=()=>I.value&&b({groupID:I.value.groupID,url:location.origin}),k=(0,o.iH)(!1),y=(0,o.iH)(!1);return(e,t)=>D.value?((0,u.wg)(),(0,u.iD)("main",St," Вы не состоите ни в одной группе ")):((0,u.wg)(),(0,u.iD)("main",Ut,[(0,u._)("div",Ct,[(0,u.Wm)((0,o.SU)(E),{groupsIDs:c.value,"current-group":g.value,onChangeGroup:t[0]||(t[0]=e=>(0,o.SU)(d).push({path:`/groupID/${e}`}))},null,8,["groupsIDs","current-group"])]),I.value?((0,u.wg)(),(0,u.iD)("section",Ht,[(0,u._)("div",Gt,[(0,u._)("button",{class:"sidebar-button",onClick:t[1]||(t[1]=e=>y.value=!y.value)},xt),(0,u._)("h1",Nt,(0,v.zw)(I.value.groupName),1),(0,u._)("button",{class:"share-button",onClick:w},qt),(0,u._)("button",{class:"info-button",onClick:t[2]||(t[2]=e=>k.value=!k.value)},Ft),(0,u.Wm)((0,o.SU)(ke),{opened:k.value,"group-info":I.value,onToggle:t[3]||(t[3]=e=>k.value=!k.value)},null,8,["opened","group-info"]),(0,u.Wm)((0,o.SU)(l.bZ),{text:(0,o.SU)(_),observer:(0,o.SU)(f)},null,8,["text","observer"])]),(0,u.Wm)(h.uT,{name:"sidebar-animation"},{default:(0,u.w5)((()=>[(0,u.wy)((0,u._)("div",Tt,[(0,u.Wm)((0,o.SU)(E),{groupsIDs:c.value,"current-group":g.value,onChangeGroup:t[4]||(t[4]=e=>(0,o.SU)(d).push({path:`/groupID/${e}`}))},null,8,["groupsIDs","current-group"])],512),[[h.F8,y.value]])])),_:1}),(0,u.Wm)(h.uT,{name:"backdrop-animation"},{default:(0,u.w5)((()=>[(0,u.wy)((0,u._)("div",{class:"sidebar-backdrop",onClick:t[5]||(t[5]=e=>y.value=!y.value)},null,512),[[h.F8,y.value]])])),_:1}),(0,u._)("div",jt,[(0,u._)("button",{onClick:t[6]||(t[6]=e=>(0,o.SU)(d).push({path:`/new-report/${(0,o.SU)(p).params.groupID}`}))},$t)]),(0,u.Wm)((0,o.SU)(Fe),{users:I.value.users.students,headStudentID:I.value.headStudentID,deputyHeadStudentID:I.value.deputyHeadStudentID,groupID:I.value.groupID},null,8,["users","headStudentID","deputyHeadStudentID","groupID"])])):(0,u.kq)("",!0)]))}});const At=(0,d.Z)(Mt,[["__scopeId","data-v-30551bd2"]]);var Lt=At;const Pt=({groupID:e})=>{const t=async(t,a)=>{const u=D.h.getters.getGroups(e.value);if(!u)return;const{error:o}=await(0,l.ib)({path:"markMethods/group.deleteRobots",data:{groupID:u.groupID,robotsIDs:t}});o?(D.h.dispatch("setError",o),console.log(o)):a&&a()},a=(0,u.Fl)((()=>{const t=D.h.getters.getGroups(e.value);if(!e.value||!t)return null;function a(e,t){const a=`${e.lastName} ${e.firstName} ${e.patronymic}`,u=`${t.lastName} ${t.firstName} ${t.patronymic}`;return a<u?-1:a>u?1:0}return[...t.users.robots].sort(a)}));return{sortedRobots:a,deleteRobot:t}};var Et=Pt;const zt=e=>((0,u.dD)("data-v-9bd08e32"),e=e(),(0,u.Cn)(),e),Ot=n+"#tabler-dots-vertical",Kt=n+"#tabler-logout",Vt={key:0,class:"student-group-nav"},Xt={class:"control-group"},Jt={class:"group-name"},Qt=zt((()=>(0,u._)("svg",{width:"22",height:"22",viewBox:"0 0 22 22"},[(0,u._)("use",{href:Ot})],-1))),ea=[Qt],ta=zt((()=>(0,u._)("svg",{width:"22",height:"22",viewBox:"0 0 22 22"},[(0,u._)("use",{href:Kt})],-1))),aa=[ta];var ua=(0,u.aZ)({__name:"StudentGroupNav",props:{groupNavItem:null,groupInfo:null},emits:["toggle"],setup(e,{emit:t}){const a=e,s=(0,o.iH)(!1),n=(0,o.iH)(!1),r=e=>e===a.groupNavItem?"selected":"";return(a,l)=>e.groupInfo?((0,u.wg)(),(0,u.iD)("nav",Vt,[(0,u._)("ul",null,[(0,u._)("li",{class:(0,v.C_)(r("Студенты"))},[(0,u._)("button",{onClick:l[0]||(l[0]=e=>t("toggle","Студенты")),class:"nav-button"},"Студенты")],2),(0,u._)("li",{class:(0,v.C_)(r("Преподаватели"))},[(0,u._)("button",{onClick:l[1]||(l[1]=e=>t("toggle","Преподаватели")),class:"nav-button"},"Преподаватели")],2)]),(0,u._)("div",Xt,[(0,u._)("p",Jt,(0,v.zw)(e.groupInfo.groupName),1),0!==e.groupInfo.institutionID?((0,u.wg)(),(0,u.iD)(u.HY,{key:0},[(0,u._)("button",{class:"popup-button",onClick:l[2]||(l[2]=e=>s.value=!s.value)},ea),(0,u.Wm)((0,o.SU)(ke),{opened:s.value,"group-info":e.groupInfo,onToggle:l[3]||(l[3]=e=>s.value=!s.value)},null,8,["opened","group-info"])],64)):((0,u.wg)(),(0,u.iD)(u.HY,{key:1},[(0,u._)("button",{class:"button-logout",onClick:l[4]||(l[4]=e=>n.value=!0)},aa),(0,u.Wm)((0,o.SU)(ue),{"is-open":n.value,onClose:l[5]||(l[5]=e=>n.value=!1)},null,8,["is-open"])],64))])])):(0,u.kq)("",!0)}});const oa=(0,d.Z)(ua,[["__scopeId","data-v-9bd08e32"]]);var sa=oa;const na=e=>((0,u.dD)("data-v-875c1ae4"),e=e(),(0,u.Cn)(),e),ra=n+"#tabler-file-description",la=n+"#tabler-hand-stop",ia=n+"#tabler-hand-off",pa=n+"#tabler-history",da={class:"mark-section"},ca=na((()=>(0,u._)("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},[(0,u._)("use",{href:ra})],-1))),ga=na((()=>(0,u._)("span",null,"Создать отчет посещаемости",-1))),va=[ca,ga],ha={key:0,width:"24",height:"24",viewBox:"0 0 24 24"},Da=na((()=>(0,u._)("use",{href:la},null,-1))),ma=[Da],Ia={key:1,width:"24",height:"24",viewBox:"0 0 24 24"},_a=na((()=>(0,u._)("use",{href:ia},null,-1))),ba=[_a],fa=na((()=>(0,u._)("span",null,"Отметиться",-1))),wa=na((()=>(0,u._)("span",null,"История отчетов",-1))),ka=na((()=>(0,u._)("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},[(0,u._)("use",{href:pa})],-1))),ya=[wa,ka];var Sa=(0,u.aZ)({__name:"MarkStudent",props:{groupID:null,studentID:null,canMakeReports:{type:Boolean}},emits:["mark"],setup(e,{emit:t}){const a=e,n=(0,r.tv)(),i=(0,u.f3)("key"),{dispatch:p}=(0,s.oR)(i),d=(0,o.iH)(!1),c=async()=>{const{error:e,response:t}=await(0,l.ib)({path:"markMethods/attendance.getAttendanceListInfo",data:{groupID:a.groupID}});e?(p("setError",e),console.log(e)):d.value=t.students.find((e=>e.userID===a.studentID)).isPresent};(0,u.bv)(c);const g=async()=>{const{error:e}=await(0,l.ib)({path:"markMethods/attendance.markUserAttendance",data:{groupID:a.groupID,usersIDs:a.studentID}});e?(console.log(e),p("setError",e)):(t("mark","Вы отмечены!"),c())},v=async()=>{const{error:e}=await(0,l.ib)({path:"markMethods/attendance.removeUserAttendance",data:{groupID:a.groupID,usersIDs:a.studentID}});e?(console.log(e),p("setError",e)):(t("mark","Отметка снята!"),c())},h=()=>{n.push({path:`/new-report/${a.groupID}`})},D=(0,u.Fl)((()=>d.value?v:g)),m=()=>{n.push({path:`/attendance/group/${a.groupID}`})};return(t,a)=>((0,u.wg)(),(0,u.iD)("section",da,[e.canMakeReports?((0,u.wg)(),(0,u.iD)("button",{key:0,onClick:h},va)):((0,u.wg)(),(0,u.iD)("button",{key:1,onClick:a[0]||(a[0]=(...e)=>(0,o.SU)(D)&&(0,o.SU)(D)(...e))},[d.value?((0,u.wg)(),(0,u.iD)("svg",ha,ma)):((0,u.wg)(),(0,u.iD)("svg",Ia,ba)),fa])),(0,u._)("button",{onClick:m,class:"mobile-reverse"},ya)]))}});const Ua=(0,d.Z)(Sa,[["__scopeId","data-v-875c1ae4"]]);var Ca=Ua;const Ha=({groupInfo:e})=>{const t=(0,o.iH)(""),a=(0,o.iH)(""),u=(0,o.iH)(""),s=async()=>{const{error:o}=await(0,l.ib)({path:"markMethods/group.addRobots",data:{groupID:e.groupID,robots:JSON.stringify([{firstName:t.value,lastName:a.value,patronymic:u.value}])}});o&&(console.log(o),D.h.dispatch("setError",o))};return{firstName:t,lastName:a,patronymic:u,addRobot:s}};var Ga=Ha;const Za=e=>((0,u.dD)("data-v-5bfa9da2"),e=e(),(0,u.Cn)(),e),xa={key:0,class:"modal"},Na={for:"firstName"},Wa=Za((()=>(0,u._)("span",null,"Имя",-1))),qa={for:"lastName"},Ra=Za((()=>(0,u._)("span",null,"Фамилия",-1))),Fa={for:"patronymic"},Ta=Za((()=>(0,u._)("span",null,"Отчество",-1))),ja={class:"button-wrapper"},Ya=["onClick"];var Ba=(0,u.aZ)({__name:"AddRobot",props:{groupInfo:null},emits:["added"],setup(e,{emit:t}){const a=e,s=(0,o.iH)(!1),{firstName:n,lastName:r,patronymic:l,addRobot:i}=Ga({groupInfo:a.groupInfo}),p=async()=>{await i(),t("added"),s.value=!1};return(e,t)=>((0,u.wg)(),(0,u.iD)(u.HY,null,[(0,u._)("button",{class:"add-button",onClick:t[0]||(t[0]=e=>s.value=!s.value)},"Добавить робота"),s.value?((0,u.wg)(),(0,u.iD)("form",xa,[(0,u._)("label",Na,[Wa,(0,u.wy)((0,u._)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>(0,o.dq)(n)?n.value=e:null),id:"firstName",required:""},null,512),[[h.nr,(0,o.SU)(n)]])]),(0,u._)("label",qa,[Ra,(0,u.wy)((0,u._)("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=e=>(0,o.dq)(r)?r.value=e:null),id:"lastName",required:""},null,512),[[h.nr,(0,o.SU)(r)]])]),(0,u._)("label",Fa,[Ta,(0,u.wy)((0,u._)("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=e=>(0,o.dq)(l)?l.value=e:null),id:"patronymic"},null,512),[[h.nr,(0,o.SU)(l)]])]),(0,u._)("div",ja,[(0,u._)("button",{class:"cancel-button",onClick:t[4]||(t[4]=(0,h.iM)((e=>s.value=!1),["prevent"]))},"Отмена"),(0,u._)("button",{class:"create-button",onClick:(0,h.iM)(p,["prevent"])},"Создать",8,Ya)])])):(0,u.kq)("",!0),s.value?((0,u.wg)(),(0,u.iD)("div",{key:1,class:"backdrop",onClick:t[5]||(t[5]=e=>s.value=!1)})):(0,u.kq)("",!0)],64))}});const $a=(0,d.Z)(Ba,[["__scopeId","data-v-5bfa9da2"]]);var Ma=$a;const Aa=e=>((0,u.dD)("data-v-851da63a"),e=e(),(0,u.Cn)(),e),La={key:0,class:"no-groups"},Pa={key:1},Ea={class:"student-group"},za={key:2,class:"robots-section"},Oa=Aa((()=>(0,u._)("h3",{class:"robots-heading"},"Роботы",-1)));var Ka=(0,u.aZ)({__name:"StudentGroups",setup(e){const t=(0,u.f3)("key"),{state:a,dispatch:n,getters:i}=(0,s.oR)(t),p=(0,r.yj)(),d=(0,r.tv)();(0,u.wF)((()=>{p.params.groupID&&d.push({path:"/"})}));const c=(0,o.iH)(null),g=()=>{a.userInfo&&(a.userInfo.additionalData.inGroups.length?c.value=a.userInfo.additionalData.inGroups[0]:c.value=0)};(0,u.wF)(g),(0,u.YP)((()=>a.userInfo),g);const v=(0,o.iH)(null),h=()=>{v.value=i.getGroups(c.value)};(0,u.bv)(h),(0,u.YP)((()=>a.groups),h);const{sortedRobots:D,deleteRobot:m}=Et({groupID:c}),I=(0,o.iH)("Студенты"),_=e=>v.value?v.value.headStudentID===e?"Староста":v.value.deputyHeadStudentID===e?"Зам. старосты":void 0:void 0,b=(0,o.iH)(""),f=(0,o.iH)(0),w=e=>{b.value=e,f.value+=1},k=(0,u.Fl)((()=>!(!v.value||!a.userInfo)&&(v.value.headStudentID===a.userInfo.id||v.value.deputyHeadStudentID===a.userInfo.id)));return(e,t)=>((0,u.wg)(),(0,u.iD)(u.HY,null,[(0,u.Wm)((0,o.SU)(l.bZ),{text:b.value,observer:f.value},null,8,["text","observer"]),0===c.value?((0,u.wg)(),(0,u.iD)("div",La," Вы не состоите ни в одной группе ")):((0,u.wg)(),(0,u.iD)("div",Pa,[(0,u.Wm)(sa,{"group-nav-item":I.value,"group-info":v.value,onToggle:t[0]||(t[0]=e=>I.value=e)},null,8,["group-nav-item","group-info"]),(0,u._)("main",Ea,[v.value&&(0,o.SU)(a).userInfo&&"Студенты"===I.value?((0,u.wg)(),(0,u.iD)(u.HY,{key:0},[(0,u.Wm)(Ca,{groupID:v.value.groupID,studentID:(0,o.SU)(a).userInfo?.id,"can-make-reports":(0,o.SU)(k),onMark:w},null,8,["groupID","studentID","can-make-reports"]),v.value.headStudentID===(0,o.SU)(a).userInfo.id?((0,u.wg)(),(0,u.j4)((0,o.SU)(Fe),{key:0,users:v.value?.users.students,headStudentID:v.value?.headStudentID,deputyHeadStudentID:v.value?.deputyHeadStudentID,groupID:v.value?.groupID},null,8,["users","headStudentID","deputyHeadStudentID","groupID"])):((0,u.wg)(),(0,u.j4)((0,o.SU)(l.to),{key:1,users:v.value?.users.students,"check-status":_},null,8,["users"])),(0,o.SU)(k)&&(0,o.SU)(D)?((0,u.wg)(),(0,u.iD)("section",za,[Oa,((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)((0,o.SU)(D),(e=>((0,u.wg)(),(0,u.iD)("div",{key:e.robotID,class:"robot"},[(0,u.Wm)((0,o.SU)(l.H_),{"full-name":`${e.lastName} ${e.firstName} ${e.patronymic}`,robotID:e.robotID,"with-options":!0,onDelete:t[1]||(t[1]=e=>(0,o.SU)(m)(e,(()=>(0,o.SU)(n)("useGroups"))))},null,8,["full-name","robotID"])])))),128)),(0,u.Wm)(Ma,{"group-info":v.value,onAdded:t[2]||(t[2]=e=>(0,o.SU)(n)("useGroups"))},null,8,["group-info"])])):(0,u.kq)("",!0)],64)):v.value&&"Преподаватели"===I.value?((0,u.wg)(),(0,u.j4)((0,o.SU)(l.to),{key:1,users:v.value?.users.teachers},null,8,["users"])):(0,u.kq)("",!0)])]))],64))}});const Va=(0,d.Z)(Ka,[["__scopeId","data-v-851da63a"]]);var Xa=Va,Ja=(0,u.aZ)({__name:"Groups",setup(e){const t=(0,u.f3)("key"),{state:a}=(0,s.oR)(t),n=e=>a.userInfo?.additionalData.roles.includes(e);return(0,u.wF)((()=>document.title="Группы")),(e,t)=>n("administrator_of_institution")?((0,u.wg)(),(0,u.j4)((0,o.SU)(_t),{key:0})):n("teacher")?((0,u.wg)(),(0,u.j4)((0,o.SU)(Lt),{key:1})):n("user")?((0,u.wg)(),(0,u.j4)((0,o.SU)(Xa),{key:2})):(0,u.kq)("",!0)}});const Qa=Ja;var eu=Qa}}]);
//# sourceMappingURL=40.1c4abce6.js.map