"use strict";(self["webpackChunkmark"]=self["webpackChunkmark"]||[]).push([[955],{955:function(t,e,a){a.r(e),a.d(e,{default:function(){return jt}});var l=a(252),n=a(262),s=a(963),i=a(907),u=a(201),o=a(577);const r={class:"institution-nav"},c={class:"nav-list"},d=["onClick"];var v=(0,l.aZ)({__name:"InstitutionNav",props:{currentNav:null},emits:["swtich"],setup(t,{emit:e}){const a=t,s=(0,n.iH)(["Структура","Преподаватели"]),i=t=>t===a.currentNav?"selected":"";return(t,a)=>((0,l.wg)(),(0,l.iD)("nav",r,[(0,l._)("ul",c,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(s.value,((t,a)=>((0,l.wg)(),(0,l.iD)("li",{key:a,class:(0,o.C_)(["nav-item",i(t)])},[(0,l._)("button",{onClick:a=>e("swtich",t)},(0,o.zw)(t),9,d)],2)))),128))])]))}}),p=a(744);const _=(0,p.Z)(v,[["__scopeId","data-v-f03112e6"]]);var h=_,m=a(235),f=a(933);const w=()=>{const t=(0,n.iH)(""),e=(0,n.iH)(""),a=(0,n.iH)(""),l=(0,n.iH)(""),s=(0,n.iH)(null),i=async()=>{const n=""===t.value||""===e.value||""===l.value;if(!f.h.state.userInfo||n)return;const{error:i,response:u}=await(0,m.ib)({path:"markMethods/institution.registerTeacher",data:{institutionID:f.h.getters.IID,firstName:t.value,lastName:e.value,patronymic:a.value,password:l.value}});i?(f.h.dispatch("setError",i),console.log(i)):s.value=u};return{firstName:t,lastName:e,patronymic:a,password:l,addTeacher:i,credentials:s}};var y=w;const b=t=>((0,l.dD)("data-v-d4baa06e"),t=t(),(0,l.Cn)(),t),g={for:"firstName"},k=b((()=>(0,l._)("span",null,"Имя",-1))),D={for:"lastName"},I=b((()=>(0,l._)("span",null,"Фамилия",-1))),C={for:"patronymic"},H=b((()=>(0,l._)("span",null,"Отчество",-1))),N={for:"patronymic"},U=b((()=>(0,l._)("span",null,"Пароль",-1))),Z=b((()=>(0,l._)("p",{class:"note"},"Если оставить пустым, то автоматически сгенерируется надежный пароль",-1))),x={class:"button-wrapper"},S=["onClick"];var q=(0,l.aZ)({__name:"NewTeacher",emits:["toggle","teacher-credentials"],setup(t,{emit:e}){const a=(0,l.f3)("key"),{dispatch:u}=(0,i.oR)(a),{firstName:o,lastName:r,patronymic:c,password:d,addTeacher:v,credentials:p}=y(),_=async()=>{await v(),u("fetchInstituion"),p.value&&e("teacher-credentials",p.value)};return(t,a)=>((0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("form",{class:"teacher-registration",onSubmit:a[5]||(a[5]=(0,s.iM)((()=>{}),["prevent"]))},[(0,l._)("label",g,[k,(0,l.wy)((0,l._)("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=t=>(0,n.dq)(o)?o.value=t:null),id:"firstName",required:""},null,512),[[s.nr,(0,n.SU)(o)]])]),(0,l._)("label",D,[I,(0,l.wy)((0,l._)("input",{type:"text","onUpdate:modelValue":a[1]||(a[1]=t=>(0,n.dq)(r)?r.value=t:null),id:"lastName",required:""},null,512),[[s.nr,(0,n.SU)(r)]])]),(0,l._)("label",C,[H,(0,l.wy)((0,l._)("input",{type:"text","onUpdate:modelValue":a[2]||(a[2]=t=>(0,n.dq)(c)?c.value=t:null),id:"patronymic"},null,512),[[s.nr,(0,n.SU)(c)]])]),(0,l._)("label",N,[U,(0,l.wy)((0,l._)("input",{type:"password","onUpdate:modelValue":a[3]||(a[3]=t=>(0,n.dq)(d)?d.value=t:null),id:"password",required:""},null,512),[[s.nr,(0,n.SU)(d)]])]),Z,(0,l._)("div",x,[(0,l._)("button",{class:"cancel-button",onClick:a[4]||(a[4]=(0,s.iM)((t=>e("toggle")),["prevent"]))},"Отмена"),(0,l._)("button",{class:"create-button",onClick:(0,s.iM)(_,["prevent"])},"Создать",8,S)])],32),(0,l._)("div",{class:"backdrop",onClick:a[6]||(a[6]=t=>e("toggle"))})],64))}});const F=(0,p.Z)(q,[["__scopeId","data-v-d4baa06e"]]);var T=F;const B=t=>((0,l.dD)("data-v-974f3922"),t=t(),(0,l.Cn)(),t),M={class:"teacher-credentials"},V=B((()=>(0,l._)("dt",null,"Логин",-1))),Y=B((()=>(0,l._)("dt",null,"Пароль",-1))),z=B((()=>(0,l._)("div",{class:"backdrop"},null,-1)));var E=(0,l.aZ)({__name:"TeacherCredentials",props:{credentials:null},emits:["close"],setup(t,{emit:e}){return(a,n)=>((0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("section",M,[(0,l._)("dl",null,[V,(0,l._)("dd",null,(0,o.zw)(t.credentials.textID),1),Y,(0,l._)("dd",null,(0,o.zw)(t.credentials.password),1)]),(0,l._)("button",{class:"button",onClick:n[0]||(n[0]=t=>e("close"))},"Закрыть")]),z],64))}});const W=(0,p.Z)(E,[["__scopeId","data-v-974f3922"]]);var j=W;const R={class:"teachers"},K={class:"list-wrapper"};var A=(0,l.aZ)({__name:"Teachers",props:{teachers:null},setup(t){const e=t,a=(0,n.iH)(!1),s=(0,n.iH)(!1),i=(0,n.iH)(null),u=t=>{a.value=!1,i.value=t,s.value=!0},o=(0,l.Fl)((()=>e.teachers?.map((t=>t.userID))));return(e,r)=>((0,l.wg)(),(0,l.iD)("main",R,[(0,l._)("div",K,[t.teachers?((0,l.wg)(),(0,l.j4)((0,n.SU)(m.to),{key:0,users:(0,n.SU)(o)},null,8,["users"])):(0,l.kq)("",!0)]),(0,l._)("button",{class:"add-button",onClick:r[0]||(r[0]=t=>a.value=!0)},"Добавить"),a.value?((0,l.wg)(),(0,l.j4)(T,{key:0,onToggle:r[1]||(r[1]=t=>a.value=!a.value),onTeacherCredentials:u})):(0,l.kq)("",!0),i.value&&s.value?((0,l.wg)(),(0,l.j4)(j,{key:1,credentials:i.value,onClose:r[2]||(r[2]=t=>s.value=!1)},null,8,["credentials"])):(0,l.kq)("",!0)]))}});const L=(0,p.Z)(A,[["__scopeId","data-v-30fa8582"]]);var $=L,G=a(562);const J=()=>{const t=(0,n.iH)(""),e=async({facultyID:e})=>{if(!f.h.state.userInfo||""===t.value)return;const{error:a}=await(0,m.ib)({path:"markMethods/institution.addDepartment",data:{institutionID:f.h.getters.IID,facultyID:e,departments:t.value}});a&&(f.h.dispatch("setError",a),console.log(a))};return{departmentName:t,addDepartment:e}};var O=J;const P=t=>((0,l.dD)("data-v-1bb4f990"),t=t(),(0,l.Cn)(),t),Q=G+"#tabler-plus",X=G+"#tabler-minus",tt={key:0,class:"add-section"},et=P((()=>(0,l._)("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},[(0,l._)("use",{href:Q})],-1))),at=[et],lt={key:1,class:"add-section"},nt=P((()=>(0,l._)("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},[(0,l._)("use",{href:X})],-1))),st=[nt],it=P((()=>(0,l._)("svg",{width:"19",height:"19",viewBox:"0 0 19 19"},[(0,l._)("use",{href:Q})],-1))),ut=[it];var ot=(0,l.aZ)({__name:"AddDepartment",props:{facultyID:null},setup(t){const e=t,a=(0,l.f3)("key"),{dispatch:u}=(0,i.oR)(a),o=(0,n.iH)(!1),{departmentName:r,addDepartment:c}=O(),d=async()=>{await c({facultyID:e.facultyID}),u("fetchInstituion"),o.value=!1};return(t,e)=>o.value?((0,l.wg)(),(0,l.iD)("div",lt,[(0,l._)("button",{class:"add-button",onClick:e[1]||(e[1]=t=>o.value=!o.value)},st),(0,l.wy)((0,l._)("input",{type:"text",placeholder:"Название","onUpdate:modelValue":e[2]||(e[2]=t=>(0,n.dq)(r)?r.value=t:null)},null,512),[[s.nr,(0,n.SU)(r)]]),(0,l._)("button",{class:"create-button desktop",onClick:d},"Добавить"),(0,l._)("button",{class:"create-button mobile",onClick:d},ut)])):((0,l.wg)(),(0,l.iD)("div",tt,[(0,l._)("button",{class:"add-button",onClick:e[0]||(e[0]=t=>o.value=!o.value)},at)]))}});const rt=(0,p.Z)(ot,[["__scopeId","data-v-1bb4f990"]]);var ct=rt;const dt=t=>((0,l.dD)("data-v-6fa05807"),t=t(),(0,l.Cn)(),t),vt=G+"#tabler-chevron-down",pt={class:"faculty"},_t={class:"title"},ht=dt((()=>(0,l._)("use",{href:vt},null,-1))),mt=[ht],ft={class:"departments"},wt={class:"deps-list"};var yt=(0,l.aZ)({__name:"Faculty",props:{info:null},setup(t){const e=(0,n.iH)(!1),a=(0,n.iH)(null);return(0,l.bv)((()=>{a.value&&a.value.addEventListener("click",(()=>{const t=a.value?.nextElementSibling;t&&(t.style.maxHeight?t.style.maxHeight="":t.style.maxHeight=`${t.scrollHeight}px`)}))})),(n,s)=>((0,l.wg)(),(0,l.iD)("section",pt,[(0,l._)("button",{class:"title-group",onClick:s[0]||(s[0]=t=>e.value=!e.value),ref_key:"button",ref:a},[(0,l._)("h6",_t,(0,o.zw)(t.info.facultyName),1),((0,l.wg)(),(0,l.iD)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",class:(0,o.C_)(e.value?"rotated":"")},mt,2))],512),(0,l._)("div",ft,[(0,l._)("ul",wt,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.info.departments,(t=>((0,l.wg)(),(0,l.iD)("li",{key:t.departmentID},(0,o.zw)(t.departmentName),1)))),128))]),(0,l.Wm)(ct,{facultyID:t.info.facultyID},null,8,["facultyID"])])]))}});const bt=(0,p.Z)(yt,[["__scopeId","data-v-6fa05807"]]);var gt=bt;const kt=()=>{const t=(0,n.iH)(""),e=async()=>{if(!f.h.state.userInfo||""===t.value)return;const{error:e}=await(0,m.ib)({path:"markMethods/institution.addFaculty",data:{institutionID:f.h.getters.IID,faculties:t.value}});e&&f.h.dispatch("setError",e)};return{facultyName:t,addFaculty:e}};var Dt=kt;const It=t=>((0,l.dD)("data-v-2b1c4eca"),t=t(),(0,l.Cn)(),t),Ct=G+"#tabler-minus",Ht=G+"#tabler-plus",Nt={key:0,class:"add-section"},Ut={key:1,class:"add-section"},Zt=It((()=>(0,l._)("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},[(0,l._)("use",{href:Ct})],-1))),xt=[Zt],St=It((()=>(0,l._)("svg",{width:"19",height:"19",viewBox:"0 0 19 19"},[(0,l._)("use",{href:Ht})],-1))),qt=[St];var Ft=(0,l.aZ)({__name:"AddFaculty",setup(t){const e=(0,l.f3)("key"),{dispatch:a}=(0,i.oR)(e),u=(0,n.iH)(!1),{facultyName:o,addFaculty:r}=Dt(),c=async()=>{await r(),a("fetchInstituion"),u.value=!1};return(t,e)=>u.value?((0,l.wg)(),(0,l.iD)("div",Ut,[(0,l._)("button",{class:"remove-button",onClick:e[1]||(e[1]=t=>u.value=!u.value)},xt),(0,l.wy)((0,l._)("input",{type:"text",placeholder:"Название","onUpdate:modelValue":e[2]||(e[2]=t=>(0,n.dq)(o)?o.value=t:null)},null,512),[[s.nr,(0,n.SU)(o)]]),(0,l._)("button",{class:"create-button desktop",onClick:c},"Добавить"),(0,l._)("button",{class:"create-button mobile",onClick:c},qt)])):((0,l.wg)(),(0,l.iD)("div",Nt,[(0,l._)("button",{class:"add-button",onClick:e[0]||(e[0]=t=>u.value=!u.value)}," Добавить факультет ")]))}});const Tt=(0,p.Z)(Ft,[["__scopeId","data-v-2b1c4eca"]]);var Bt=Tt;const Mt={class:"faculties"};var Vt=(0,l.aZ)({__name:"Faculties",props:{faculties:null},setup(t){return(e,a)=>((0,l.wg)(),(0,l.iD)("main",Mt,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.faculties,((t,e)=>((0,l.wg)(),(0,l.j4)(gt,{key:e,info:t},null,8,["info"])))),128)),(0,l.Wm)(Bt)]))}});const Yt=(0,p.Z)(Vt,[["__scopeId","data-v-22e90bd2"]]);var zt=Yt,Et=(0,l.aZ)({__name:"Institution",setup(t){const e=(0,l.f3)("key"),{getters:a,state:o}=(0,i.oR)(e),r=(0,u.tv)();(0,l.wF)((()=>document.title="Учреждение")),a.roles?.includes("administrator_of_institution")||r.push({path:"/notfound"});const c=(0,n.iH)("Структура"),d=(0,l.Fl)((()=>"Преподаватели"===c.value&&o.institution)),v=(0,l.Fl)((()=>"Структура"===c.value&&o.institution));return(t,e)=>((0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(h,{"current-nav":c.value,onSwtich:e[0]||(e[0]=t=>c.value=t)},null,8,["current-nav"]),(0,l.wy)((0,l.Wm)($,{teachers:(0,n.SU)(o).institution?.additionalData.staff.teachers},null,8,["teachers"]),[[s.F8,(0,n.SU)(d)]]),(0,l.wy)((0,l.Wm)(zt,{faculties:(0,n.SU)(o).institution?.additionalData.faculties},null,8,["faculties"]),[[s.F8,(0,n.SU)(v)]])],64))}});const Wt=(0,p.Z)(Et,[["__scopeId","data-v-b430d776"]]);var jt=Wt}}]);
//# sourceMappingURL=955.473ca1f1.js.map