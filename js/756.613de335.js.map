{"version":3,"file":"js/756.613de335.js","mappings":"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","sources":["webpack://mark/./src/pages/Attendance/hooks/useValidation.ts","webpack://mark/./src/pages/Attendance/hooks/useReports.ts","webpack://mark/./src/pages/Attendance/hooks/useSortedReports.ts","webpack://mark/./src/pages/Attendance/Attendance.vue?86e1","webpack://mark/./src/pages/Attendance/Attendance.vue"],"sourcesContent":["/* eslint no-param-reassign: off */\r\nimport { store } from '@/store'\r\nimport { Ref, ref } from 'vue'\r\nimport { Router, RouteLocationNormalizedLoaded } from \"vue-router\"\r\n\r\ninterface IParams {\r\n  router: Router,\r\n  route: RouteLocationNormalizedLoaded\r\n}\r\n\r\nconst useUserValidation = ({ router, route }: IParams, isValid: Ref<boolean>) => {\r\n  const pushToStartingRoute = () => {\r\n    if (\r\n      !store.getters.roles\r\n      || !store.state.userInfo\r\n      //|| !store.state.institution\r\n    ) return\r\n\r\n    const isTeacher = store.getters.roles.includes('teacher')\r\n    if (isTeacher && store.state.userInfo.id) {\r\n      router.push({ path: `/attendance/user/${store.state.userInfo.id}` })\r\n      return\r\n    }\r\n\r\n    if (!store.state.institution) return\r\n    const isAdminUU = store.getters.roles.includes('administrator_of_institution')\r\n    if (isAdminUU) {\r\n      const { teachers } = store.state.institution.additionalData.staff\r\n      if (teachers.length)\r\n        router.push({ path: `/attendance/user/${teachers[0].userID}` })\r\n      else\r\n        router.push({ path: '/notfound' })\r\n      return\r\n    }\r\n\r\n    router.push({ path: '/notfound' })\r\n  }\r\n\r\n  const validateUser = () => {\r\n    if (\r\n      !store.getters.roles\r\n      || !store.state.userInfo\r\n      //|| !store.state.institution\r\n      || !route.path.startsWith('/attendance/user')\r\n    ) return\r\n\r\n    if (!route.params.userID) {\r\n      pushToStartingRoute()\r\n      return\r\n    }\r\n\r\n    if (store.getters.roles.includes('teacher')) {\r\n      const userID = +(route.params.userID as string)\r\n      if (userID === store.state.userInfo.id) isValid.value = true\r\n      else pushToStartingRoute()\r\n      return\r\n    }\r\n\r\n    if (!store.state.institution) return\r\n    const isAdminUU = store.getters.roles.includes('administrator_of_institution')\r\n    if (isAdminUU) {\r\n      const userID = +(route.params.userID as string)\r\n      const { teachers } = store.state.institution.additionalData.staff\r\n      if (teachers.map(t => t.userID).includes(userID)) isValid.value = true\r\n      else pushToStartingRoute()\r\n      return\r\n    }\r\n\r\n    router.push({ path: '/notfound' })\r\n  }\r\n\r\n  return validateUser\r\n}\r\n\r\nconst useGroupValidation = ({ router, route }: IParams, isValid: Ref<boolean>) => {\r\n  const pushToStartingRoute = () => {\r\n    if (\r\n      !store.getters.roles\r\n      || !store.state.userInfo\r\n      //|| !store.state.institution\r\n    ) return\r\n\r\n    const isStudent = !store.getters.roles.includes('teacher')\r\n      && !store.getters.roles.includes('administrator_of_institution')\r\n    if (isStudent) {\r\n      const groups = store.state.userInfo.additionalData.inGroups\r\n      if (groups.length)\r\n        router.push({ path: `/attendance/group/${groups[0]}` })\r\n      else\r\n        router.push({ path: '/notfound' })\r\n      return\r\n    }\r\n\r\n    if (!store.state.institution) return\r\n    if (store.getters.roles.includes('administrator_of_institution')) {\r\n      const { groups } = store.state.institution\r\n      if (groups.length)\r\n        router.push({ path: `/attendance/group/${groups[0]}` })\r\n      else\r\n        router.push({ path: '/notfound' })\r\n      return\r\n    }\r\n\r\n    router.push({ path: '/notfound' })\r\n  }\r\n\r\n  const validateGroup = () => {\r\n    if (\r\n      !store.getters.roles\r\n      || !store.state.userInfo\r\n      //|| !store.state.institution\r\n      || !route.path.startsWith('/attendance/group')\r\n    ) return\r\n\r\n    if (!route.params.groupID) {\r\n      pushToStartingRoute()\r\n      return\r\n    }\r\n\r\n    const isStudent = !store.getters.roles.includes('teacher')\r\n      && !store.getters.roles.includes('administrator_of_institution')\r\n    if (isStudent) {\r\n      const group = +(route.params.groupID)\r\n      const groups = store.state.userInfo.additionalData.inGroups\r\n      if (groups.includes(group)) isValid.value = true\r\n      else pushToStartingRoute()\r\n      return\r\n    }\r\n\r\n    if (!store.state.institution) return\r\n    if (store.getters.roles.includes('administrator_of_institution')) {\r\n      const group = +(route.params.groupID)\r\n      const { groups } = store.state.institution\r\n      if (groups.includes(group)) isValid.value = true\r\n      else pushToStartingRoute()\r\n      return\r\n    }\r\n\r\n    router.push({ path: '/notfound' })\r\n  }\r\n\r\n  return validateGroup\r\n}\r\n\r\nconst useValidation = ({ router, route }: IParams) => {\r\n  const isValid = ref(false)\r\n\r\n  const validateUser = useUserValidation({ route, router }, isValid)\r\n  const validateGroup = useGroupValidation({ route, router }, isValid)\r\n\r\n  const validate = () => {\r\n    if (route.path.startsWith('/attendance/group')) validateGroup()\r\n    if (route.path.startsWith('/attendance/user')) validateUser()\r\n  }\r\n\r\n  const validationDeps = [\r\n    () => store.getters.roles,\r\n    () => store.state.userInfo,\r\n    () => store.state.institution,\r\n    () => route.params.groupID,\r\n    () => route.params.userID\r\n  ]\r\n\r\n  return { validate, isValid, validationDeps }\r\n}\r\n\r\nexport default useValidation\r\n","import { ref } from 'vue'\r\nimport { useFetch, IError } from '@/shared'\r\nimport { store } from '@/store'\r\nimport { IReportInfo } from '@/features/reports'\r\n\r\ninterface IParams {\r\n  groupID?: number,\r\n  userID?: number\r\n}\r\n\r\nconst useReports = () => {\r\n  const fetchFrom = ref(0)\r\n  const isOver = ref(false)\r\n\r\n  const reportsInfo = ref<IReportInfo[] | null>(null)\r\n\r\n  const fetchReports = async ({ groupID, userID }: IParams) => {\r\n    if (!groupID && !userID) return\r\n    if (isOver.value) return\r\n\r\n    const getData = () => {\r\n      if (groupID) {\r\n        return {\r\n          groupID,\r\n          limit: `${fetchFrom.value},20`\r\n        }\r\n      }\r\n      if (userID) {\r\n        return {\r\n          sendedTo: userID,\r\n          limit: `${fetchFrom.value},20`\r\n        }\r\n      }\r\n      return {}\r\n    }\r\n\r\n    const { response, error } = await useFetch({\r\n      path: 'markMethods/attendance.getAttendanceReportsInfo',\r\n      data: getData()\r\n    })\r\n\r\n    if (error) {\r\n      console.log(error)\r\n      store.dispatch('setError', error as IError)\r\n    } else {\r\n      if (!reportsInfo.value && response.length === 0) {\r\n        reportsInfo.value === response\r\n        isOver.value = true\r\n      } else if (response.length === 0) {\r\n        isOver.value = true\r\n        return\r\n      }\r\n\r\n      reportsInfo.value = reportsInfo.value\r\n        ? [...reportsInfo.value, ...response as IReportInfo[]]\r\n        : response as IReportInfo[]\r\n      fetchFrom.value += 20\r\n    }\r\n  }\r\n\r\n  return { fetchReports, reportsInfo, isOver }\r\n}\r\n\r\nexport default useReports\r\n","import { ref, computed, Ref } from 'vue'\r\nimport { IReportInfo, useTime } from '@/features/reports'\r\n\r\ninterface IParams {\r\n  reportsInfo: Ref<IReportInfo[] | null>\r\n}\r\n\r\nconst useSortedReports = ({ reportsInfo }: IParams) => {\r\n  type Sort = 'latest' | 'oldest'\r\n  const sort = ref<Sort>('latest')\r\n\r\n  const sortedReports = computed(() => {\r\n    if (!reportsInfo.value) return null\r\n\r\n    const { setTime } = useTime()\r\n\r\n    if (sort.value === 'latest')\r\n      return reportsInfo.value.map(r => setTime(r))\r\n    else\r\n      return [...reportsInfo.value].reverse().map(r => setTime(r))\r\n  })\r\n\r\n  return { sort, sortedReports }\r\n}\r\n\r\nexport default useSortedReports\r\n","import { defineComponent as _defineComponent } from 'vue'\nimport { unref as _unref, createVNode as _createVNode, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, normalizeClass as _normalizeClass, createBlock as _createBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString, resolveComponent as _resolveComponent, withCtx as _withCtx, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\nimport _imports_0 from '@/assets/tabler-sprite.svg'\n\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-3ce469c2\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = _imports_0 + '#tabler-arrows-sort'\nconst _hoisted_2 = _imports_0 + '#tabler-chevron-right'\nconst _hoisted_3 = { class: \"sort-group\" }\nconst _hoisted_4 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"svg\", {\n  class: \"sort-icon\",\n  width: \"24\",\n  height: \"24\",\n  viewBox: \"0 0 24 24\"\n}, [\n  /*#__PURE__*/_createElementVNode(\"use\", { href: _hoisted_1 })\n], -1))\nconst _hoisted_5 = {\n  key: 0,\n  class: \"filter-wrapper\"\n}\nconst _hoisted_6 = {\n  key: 0,\n  class: \"no-reports\"\n}\nconst _hoisted_7 = {\n  key: 1,\n  class: \"reports-list\"\n}\nconst _hoisted_8 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"svg\", {\n  width: \"22\",\n  height: \"22\",\n  viewBox: \"0 0 22 22\"\n}, [\n  /*#__PURE__*/_createElementVNode(\"use\", { href: _hoisted_2 })\n], -1))\n\nimport {\r\n  onBeforeMount, onMounted, watch, computed, ref\r\n} from 'vue'\r\nimport { useRouter, useRoute } from 'vue-router'\r\nimport { Alert } from '@/shared'\r\nimport { GroupsFilter } from '@/features/reports'\r\nimport useValidation from './hooks/useValidation'\r\nimport useReports from './hooks/useReports'\r\nimport useSortedReports from './hooks/useSortedReports'\r\n\r\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'Attendance',\n  setup(__props) {\n\r\nconst router = useRouter()\r\nconst route = useRoute()\r\n\r\n// watch for router.options.history.state.back\r\n\r\nconst { validate, isValid, validationDeps } = useValidation({ route, router })\r\nonBeforeMount(validate)\r\nwatch(validationDeps, validate)\r\n\r\nconst { fetchReports, reportsInfo, isOver } = useReports()\r\nconst getReports = () => {\r\n  if (!isValid.value) return\r\n  if (route.params.groupID) {\r\n    fetchReports({\r\n      groupID: +(route.params.groupID as string)\r\n    })\r\n  } else {\r\n    fetchReports({\r\n      userID: +(route.params.userID as string)\r\n    })\r\n  }\r\n}\r\n//onMounted(getReports)\r\nwatch([\r\n  isValid,\r\n  () => route.params.groupID,\r\n  () => route.params.userID\r\n], getReports)\r\n\r\nconst { sort, sortedReports } = useSortedReports({ reportsInfo })\r\n\r\nconst currentGroupID = ref<null | number>(null)\r\nconst filteredReports = computed(() => {\r\n  if (!sortedReports.value) return null\r\n  if (currentGroupID.value === null) return sortedReports.value\r\n  return sortedReports.value.filter(r => r.groupID === currentGroupID.value)\r\n})\r\nconst groupsList = computed(() => {\r\n  if (!sortedReports.value) return null\r\n\r\n  return [...new Map(\r\n    sortedReports.value.map(r => [r.groupName, r])\r\n  ).values()].map(r => ({ groupName: r.groupName, groupID: r.groupID }))\r\n})\r\n\r\nonBeforeMount(() => document.title = 'Посещаемость')\r\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_router_link = _resolveComponent(\"router-link\")!\n\n  return (_openBlock(), _createElementBlock(_Fragment, null, [\n    _createVNode(_unref(Alert), {\n      text: \"Отчеты закончились!\",\n      observer: _unref(isOver)\n    }, null, 8, [\"observer\"]),\n    _createElementVNode(\"nav\", null, [\n      _createElementVNode(\"div\", _hoisted_3, [\n        _hoisted_4,\n        _createElementVNode(\"button\", {\n          class: _normalizeClass([\"sort-button --mobile --no-margin\", _unref(sort) === 'latest' ? 'selected' : '']),\n          onClick: _cache[0] || (_cache[0] = ($event: any) => (sort.value = 'latest'))\n        }, \" Новые \", 2),\n        _createElementVNode(\"button\", {\n          class: _normalizeClass([\"sort-button --desktop\", _unref(sort) === 'latest' ? 'selected' : '']),\n          onClick: _cache[1] || (_cache[1] = ($event: any) => (sort.value = 'latest'))\n        }, \" Сначала новые \", 2),\n        _createElementVNode(\"button\", {\n          class: _normalizeClass([\"sort-button --desktop\", _unref(sort) === 'oldest' ? 'selected' : '']),\n          onClick: _cache[2] || (_cache[2] = ($event: any) => (sort.value = 'oldest'))\n        }, \" Сначала старые \", 2),\n        _createElementVNode(\"button\", {\n          class: _normalizeClass([\"sort-button --mobile\", _unref(sort) === 'oldest' ? 'selected' : '']),\n          onClick: _cache[3] || (_cache[3] = ($event: any) => (sort.value = 'oldest'))\n        }, \" Старые \", 2)\n      ]),\n      (_unref(route).params.userID)\n        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [\n            (_unref(groupsList))\n              ? (_openBlock(), _createBlock(_unref(GroupsFilter), {\n                  key: 0,\n                  groups: _unref(groupsList),\n                  currentGroupID: currentGroupID.value,\n                  onSwitch: _cache[4] || (_cache[4] = groupID => currentGroupID.value = groupID)\n                }, null, 8, [\"groups\", \"currentGroupID\"]))\n              : _createCommentVNode(\"\", true)\n          ]))\n        : _createCommentVNode(\"\", true)\n    ]),\n    (_unref(sortedReports) && _unref(sortedReports).length === 0)\n      ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, \" У вас нет отчетов \"))\n      : (_unref(filteredReports))\n        ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_7, [\n            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(filteredReports), (report, i) => {\n              return (_openBlock(), _createElementBlock(\"li\", { key: i }, [\n                _createVNode(_component_router_link, {\n                  to: `/report/${report.textID}`\n                }, {\n                  default: _withCtx(() => [\n                    _createElementVNode(\"div\", null, [\n                      _createElementVNode(\"span\", null, _toDisplayString(report.date), 1),\n                      _createElementVNode(\"span\", null, _toDisplayString(report.groupName), 1),\n                      _createElementVNode(\"span\", null, _toDisplayString(report.institutionData.shortName), 1)\n                    ]),\n                    _hoisted_8\n                  ]),\n                  _: 2\n                }, 1032, [\"to\"])\n              ]))\n            }), 128)),\n            _createElementVNode(\"button\", {\n              onClick: getReports,\n              class: \"load-button\"\n            }, \"Далее\")\n          ]))\n        : _createCommentVNode(\"\", true)\n  ], 64))\n}\n}\n\n})","import script from \"./Attendance.vue?vue&type=script&lang=ts&setup=true\"\nexport * from \"./Attendance.vue?vue&type=script&lang=ts&setup=true\"\n\nimport \"./Attendance.vue?vue&type=style&index=0&id=3ce469c2&lang=scss&scoped=true\"\n\nimport exportComponent from \"G:\\\\Programming\\\\Apps\\\\mark\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-3ce469c2\"]])\n\nexport default __exports__"],"names":["useUserValidation","router","route","isValid","pushToStartingRoute","store","isTeacher","push","path","isAdminUU","teachers","length","userID","validateUser","startsWith","params","value","map","t","includes","useGroupValidation","isStudent","groups","validateGroup","groupID","group","useValidation","ref","validate","validationDeps","useReports","fetchFrom","isOver","reportsInfo","fetchReports","async","getData","limit","sendedTo","response","error","useFetch","data","console","log","useSortedReports","sort","sortedReports","computed","setTime","useTime","r","reverse","_withScopeId","n","_pushScopeId","_popScopeId","_hoisted_1","_imports_0","_hoisted_2","_hoisted_3","class","_hoisted_4","_createElementVNode","width","height","viewBox","href","_hoisted_5","key","_hoisted_6","_hoisted_7","_hoisted_8","_defineComponent","__name","setup","__props","useRouter","useRoute","onBeforeMount","watch","getReports","currentGroupID","filteredReports","filter","groupsList","Map","groupName","values","document","title","_ctx","_cache","_component_router_link","_resolveComponent","_openBlock","_createElementBlock","_Fragment","_createVNode","_unref","Alert","text","observer","_normalizeClass","onClick","$event","_createBlock","GroupsFilter","onSwitch","_createCommentVNode","_renderList","report","i","to","textID","default","_withCtx","_toDisplayString","date","institutionData","shortName","_","__exports__"],"sourceRoot":""}