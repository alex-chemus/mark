{"version":3,"file":"js/707.cff7002b.js","mappings":"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","sources":["webpack://mark/./src/pages/Report/hooks/useReport.ts","webpack://mark/./src/pages/Report/Report.vue?f0ec","webpack://mark/./src/pages/Report/Report.vue"],"sourcesContent":["import { ref } from 'vue'\r\nimport { RouteLocationNormalizedLoaded } from 'vue-router'\r\nimport { store } from '@/store'\r\nimport { useFetch, IError } from '@/shared'\r\nimport { IReportInfo, useTime } from '@/features/reports'\r\n\r\ninterface IParams {\r\n  route: RouteLocationNormalizedLoaded\r\n}\r\n\r\nconst useReport = ({ route }: IParams) => {\r\n  const report = ref<IReportInfo | null>(null)\r\n\r\n  const fetchReport = async () => {\r\n    const { response, error } = await useFetch({\r\n      path: 'markMethods/attendance.getAttendanceReportsInfo',\r\n      data: {\r\n        reportsIDs: route.params.reportID\r\n      }\r\n    })\r\n\r\n    const { setTime } = useTime()\r\n\r\n    if (error) {\r\n      console.log(error)\r\n      store.dispatch('setError', error as IError)\r\n    } else {\r\n      report.value = setTime(response[0] as IReportInfo)\r\n    }\r\n  }\r\n\r\n  return { report, fetchReport }\r\n}\r\n\r\nexport default useReport\r\n","import { defineComponent as _defineComponent } from 'vue'\nimport { unref as _unref, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, createVNode as _createVNode, Fragment as _Fragment, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\nimport _imports_0 from '@/assets/tabler-sprite.svg'\n\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-360d42b4\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = _imports_0 + '#tabler-arrow-left'\nconst _hoisted_2 = _imports_0 + '#tabler-edit'\nconst _hoisted_3 = {\n  key: 0,\n  class: \"nav\"\n}\nconst _hoisted_4 = { class: \"title-group\" }\nconst _hoisted_5 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"svg\", {\n  width: \"24\",\n  height: \"24\",\n  viewBox: \"0 0 24 24\"\n}, [\n  /*#__PURE__*/_createElementVNode(\"use\", { href: _hoisted_1 })\n], -1))\nconst _hoisted_6 = [\n  _hoisted_5\n]\nconst _hoisted_7 = { class: \"heading\" }\nconst _hoisted_8 = { class: \"desktop-filter\" }\nconst _hoisted_9 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"span\", null, \"Редактировать\", -1))\nconst _hoisted_10 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"svg\", {\n  width: \"24\",\n  height: \"24\",\n  viewBox: \"0 0 24 24\"\n}, [\n  /*#__PURE__*/_createElementVNode(\"use\", { href: _hoisted_2 })\n], -1))\nconst _hoisted_11 = [\n  _hoisted_9,\n  _hoisted_10\n]\nconst _hoisted_12 = {\n  key: 1,\n  class: \"main\"\n}\nconst _hoisted_13 = { class: \"mobile-controls\" }\nconst _hoisted_14 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"span\", null, \"Редактировать\", -1))\nconst _hoisted_15 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"svg\", {\n  width: \"24\",\n  height: \"24\",\n  viewBox: \"0 0 24 24\"\n}, [\n  /*#__PURE__*/_createElementVNode(\"use\", { href: _hoisted_2 })\n], -1))\nconst _hoisted_16 = [\n  _hoisted_14,\n  _hoisted_15\n]\n\nimport {\r\n  ref, inject, onMounted, watch, computed, onBeforeMount\r\n} from 'vue'\r\nimport { useRoute, useRouter } from 'vue-router'\r\nimport { PresenceUsers, AttendanceFilter } from '@/features/reports'\r\nimport { Key, IGroupInfo } from '@/store'\r\nimport { useStore } from 'vuex'\r\nimport useReport from './hooks/useReport'\r\n\r\ntype Filter = 'all' | 'absent' | 'present'\r\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'Report',\n  setup(__props) {\n\r\nconst route = useRoute()\r\nconst router = useRouter()\r\n\r\nconst key = inject<Key>('key')\r\nconst { getters, state } = useStore(key)\r\n\r\nconst { report, fetchReport } = useReport({ route })\r\n\r\n\r\nonMounted(fetchReport)\r\nwatch(() => route.params.reportID, fetchReport)\r\n\r\nconst groupInfo = ref<IGroupInfo | null>(null)\r\nwatch([report, () => state.groups], () => {\r\n  if (!report.value) return\r\n  groupInfo.value = getters.getGroups(report.value.groupID)\r\n})\r\n\r\nconst filter = ref<Filter>('all')\r\n\r\nconst checkStatus = (userID: number | string) => {\r\n  /* eslint-disable */\r\n  if (!groupInfo.value || typeof userID === 'string') return\r\n  if (groupInfo.value.headStudentID === userID) return 'Староста'\r\n  if (groupInfo.value.deputyHeadStudentID === userID) return 'Зам. старосты'\r\n  return\r\n  /* eslint-enable */\r\n}\r\n\r\nconst canEdit = computed(() => {\r\n  if (!state.userInfo || !groupInfo.value) return false\r\n  const isTeacher = getters.roles.includes('teacher')\r\n  const isAdmin = getters.roles.includes('administrator_of_institution')\r\n  //const isHeadStudent = state.userInfo.institutionData.groupStatus === 'head_student'\r\n  //const isDeputyStudent = state.userInfo.institutionData.groupStatus === 'deputy_head_student'\r\n  const isHeadStudent = state.userInfo.id === groupInfo.value.headStudentID\r\n  const isDeputyStudent = state.userInfo.id === groupInfo.value.deputyHeadStudentID\r\n  return isTeacher || isAdmin || isHeadStudent || isDeputyStudent\r\n})\r\n\r\nonBeforeMount(() => document.title = 'Отчет посещаемости')\r\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(_Fragment, null, [\n    (_unref(report))\n      ? (_openBlock(), _createElementBlock(\"nav\", _hoisted_3, [\n          _createElementVNode(\"div\", _hoisted_4, [\n            (_unref(router).options.history.state.back)\n              ? (_openBlock(), _createElementBlock(\"button\", {\n                  key: 0,\n                  class: \"back-button\",\n                  onClick: _cache[0] || (_cache[0] = ($event: any) => (_unref(router).go(-1)))\n                }, _hoisted_6))\n              : _createCommentVNode(\"\", true),\n            _createElementVNode(\"h1\", _hoisted_7, [\n              _createElementVNode(\"span\", null, _toDisplayString(_unref(report).date), 1),\n              _createElementVNode(\"span\", null, _toDisplayString(_unref(report).groupName), 1),\n              _createElementVNode(\"span\", null, _toDisplayString(_unref(report).institutionData.shortName), 1)\n            ])\n          ]),\n          _createElementVNode(\"div\", _hoisted_8, [\n            (_unref(canEdit))\n              ? (_openBlock(), _createElementBlock(\"button\", {\n                  key: 0,\n                  class: \"edit-button\",\n                  onClick: _cache[1] || (_cache[1] = ($event: any) => (_unref(router).push({ path: `/edit-report/${_unref(route).params.reportID}` })))\n                }, _hoisted_11))\n              : _createCommentVNode(\"\", true),\n            _createVNode(_unref(AttendanceFilter), {\n              filter: filter.value,\n              onSwitch: _cache[2] || (_cache[2] = value => filter.value = value)\n            }, null, 8, [\"filter\"])\n          ])\n        ]))\n      : _createCommentVNode(\"\", true),\n    (_unref(report))\n      ? (_openBlock(), _createElementBlock(\"main\", _hoisted_12, [\n          _createElementVNode(\"div\", _hoisted_13, [\n            _createElementVNode(\"button\", {\n              class: \"edit-button\",\n              onClick: _cache[3] || (_cache[3] = ($event: any) => (_unref(router).push({ path: `/edit-report/${_unref(route).params.reportID}` })))\n            }, _hoisted_16),\n            _createVNode(_unref(AttendanceFilter), {\n              filter: filter.value,\n              onSwitch: _cache[4] || (_cache[4] = value => filter.value = value)\n            }, null, 8, [\"filter\"])\n          ]),\n          _createVNode(_unref(PresenceUsers), {\n            \"users-data\": _unref(report).students,\n            filter: filter.value,\n            \"check-status\": checkStatus\n          }, null, 8, [\"users-data\", \"filter\"])\n        ]))\n      : _createCommentVNode(\"\", true)\n  ], 64))\n}\n}\n\n})","import script from \"./Report.vue?vue&type=script&lang=ts&setup=true\"\nexport * from \"./Report.vue?vue&type=script&lang=ts&setup=true\"\n\nimport \"./Report.vue?vue&type=style&index=0&id=360d42b4&lang=scss&scoped=true\"\n\nimport exportComponent from \"G:\\\\Programming\\\\Apps\\\\mark\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-360d42b4\"]])\n\nexport default __exports__"],"names":["useReport","route","report","ref","fetchReport","async","response","error","useFetch","path","data","reportsIDs","params","reportID","setTime","useTime","console","log","store","value","_withScopeId","n","_pushScopeId","_popScopeId","_hoisted_1","_imports_0","_hoisted_2","_hoisted_3","key","class","_hoisted_4","_hoisted_5","_createElementVNode","width","height","viewBox","href","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_defineComponent","__name","setup","__props","useRoute","router","useRouter","inject","getters","state","useStore","onMounted","watch","groupInfo","groups","getGroups","groupID","filter","checkStatus","userID","headStudentID","deputyHeadStudentID","canEdit","computed","userInfo","isTeacher","roles","includes","isAdmin","isHeadStudent","id","isDeputyStudent","onBeforeMount","document","title","_ctx","_cache","_openBlock","_createElementBlock","_Fragment","_unref","options","history","back","onClick","$event","go","_createCommentVNode","_toDisplayString","date","groupName","institutionData","shortName","push","_createVNode","AttendanceFilter","onSwitch","PresenceUsers","students","__exports__"],"sourceRoot":""}