"use strict";(self["webpackChunkmark"]=self["webpackChunkmark"]||[]).push([[53],{53:function(e,t,a){a.d(t,{LV:function(){return ce},Yh:function(){return De},rF:function(){return se},LW:function(){return C},ML:function(){return B},rE:function(){return _e}});var s=a(252),l=a(262),r=a(235),u=a(577),n=a(963),i=a(562);const o=e=>((0,s.dD)("data-v-43c01f5c"),e=e(),(0,s.Cn)(),e),c=i+"#tabler-check",d={width:"22",height:"22",viewBox:"0 0 22 22"},v=o((()=>(0,s._)("use",{href:c},null,-1))),p=[v];var f=(0,s.aZ)({__name:"ReportCheckbox",props:{state:{type:Boolean}},emits:["toggle"],setup(e,{emit:t}){return(a,l)=>((0,s.wg)(),(0,s.iD)("button",{class:"checkbox",onClick:l[0]||(l[0]=e=>t("toggle"))},[(0,s._)("div",{class:(0,u.C_)(["field",e.state?"checked":"none"])},[(0,s.wy)(((0,s.wg)(),(0,s.iD)("svg",d,p,512)),[[n.F8,e.state]])],2)]))}}),m=a(744);const g=(0,m.Z)(f,[["__scopeId","data-v-43c01f5c"]]);var h=g,D=(0,s.aZ)({__name:"ReportUser",props:{avatar:null,fullName:null,uid:null,badgeText:null,isPresent:{type:Boolean}},emits:["toggle"],setup(e,{emit:t}){return(a,u)=>((0,s.wg)(),(0,s.iD)("button",{class:"report-user",onClick:u[0]||(u[0]=e=>t("toggle"))},[(0,s.Wm)(h,{state:e.isPresent},null,8,["state"]),(0,s.Wm)((0,l.SU)(r.n5),{avatar:e.avatar,"full-name":e.fullName,"badge-text":e.badgeText},null,8,["avatar","full-name","badge-text"])]))}});const b=(0,m.Z)(D,[["__scopeId","data-v-6a2e1872"]]);var _=b,k=a(933);const w=()=>{const e=(0,l.iH)(null),t=async({usersData:t})=>{const{response:a,error:s}=await(0,r.ib)({path:"methods/users.getInfo",data:{userIds:t.map((e=>e.userID)).filter((e=>"number"===typeof e))}});s?(k.h.dispatch("setError",s),console.log(s)):(e.value=a.map((e=>({uid:+e.id,fullName:`${e.lastName} ${e.firstName} ${e.patronymic}`,avatar:e.additionalData.avatarData.avatarCompressed,isPresent:t.some((t=>t.userID===+e.id&&t.isPresent))}))),e.value?.push(...t.filter((e=>"string"===typeof e.userID)).map((e=>({uid:e.userID,fullName:`${e.lastName} ${e.firstName} ${e.patronymic}`,avatar:k.h.state.defaultAvatar,isPresent:t.some((t=>t.userID===e.userID&&t.isPresent))})))))};return{users:e,fetchUsers:t}};var I=w;const N={key:0,class:"users-list"};var $=(0,s.aZ)({__name:"ReportUsers",props:{usersData:null,checkStatus:null},emits:["edit"],setup(e,{emit:t}){const a=e,{users:r,fetchUsers:u}=I();(0,s.bv)((()=>u({usersData:a.usersData})));const n=(0,l.iH)();(0,s.YP)(r,(()=>{if(!r.value)return;const e=[];for(let t=0;t<r.value.length;t++){const{userID:s}=a.usersData[t],l=r.value.find((e=>e.uid===s));l&&e.push(l)}n.value=e}));const i=()=>{n.value&&(n.value=[...a.usersData].map(((e,t)=>({uid:e.userID,fullName:`${e.lastName} ${e.firstName} ${e.patronymic}`,avatar:n.value[t].avatar,isPresent:e.isPresent}))))};(0,s.YP)((()=>a.usersData),i);const o=(0,s.Fl)((()=>{if(!n.value)return null;function e(e,t){return e.fullName<t.fullName?-1:e.fullName>t.fullName?1:0}return[...n.value].sort(e)}));return(a,u)=>(0,l.SU)(r)?((0,s.wg)(),(0,s.iD)("ul",N,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)((0,l.SU)(o),(a=>((0,s.wg)(),(0,s.iD)("li",{key:a.uid},[(0,s.Wm)(_,{avatar:a.avatar,"full-name":a.fullName,uid:a.uid,"badge-text":e.checkStatus?e.checkStatus(a.uid):void 0,"is-present":a.isPresent,onToggle:e=>t("edit",a.uid)},null,8,["avatar","full-name","uid","badge-text","is-present","onToggle"])])))),128))])):(0,s.kq)("",!0)}});const y=(0,m.Z)($,[["__scopeId","data-v-9bfbb6a8"]]);var C=y,x=a(907);const P=["value"];var S=(0,s.aZ)({__name:"SidebarSearch",props:{teachers:null},emits:["input"],setup(e,{emit:t}){const a=e,r=(0,l.iH)(""),u=e=>{const s=e.target;r.value=s.value;const l=a.teachers.filter((e=>{const t=new RegExp(r.value.toLowerCase().trim());return t.test(e.fullName.toLowerCase().trim())})).map((e=>e.id));t("input",l)};return(e,t)=>((0,s.wg)(),(0,s.iD)("input",{type:"text",onInput:u,value:r.value,placeholder:"Поиск"},null,40,P))}});const Z=(0,m.Z)(S,[["__scopeId","data-v-5d66c5d8"]]);var U=Z;const H=e=>((0,s.dD)("data-v-79b3773d"),e=e(),(0,s.Cn)(),e),Y={key:0},F=H((()=>(0,s._)("div",{class:"separator"},null,-1))),T=H((()=>(0,s._)("h2",{class:"title"},"Преподаватели",-1))),W=["onClick"];var q=(0,s.aZ)({__name:"TeachersSidebar",props:{teacherIDs:null,selectedIDs:null},emits:["select"],setup(e,{emit:t}){const a=e,n=(0,s.f3)("key"),{dispatch:i}=(0,x.oR)(n),o=(0,l.iH)(null),c=async()=>{const{response:e,error:t}=await(0,r.ib)({path:"methods/users.getInfo",data:{userIds:a.teacherIDs}});t?(console.log("error"),i("setError",t)):o.value=e.map((e=>({id:+e.id,fullName:`${e.lastName} ${e.firstName} ${e.patronymic}`})))};(0,s.bv)(c),(0,s.YP)((()=>a.teacherIDs),c);const d=(0,l.iH)(null),v=(0,s.Fl)((()=>{function e(e,t){return e.fullName<t.fullName?-1:e.fullName>t.fullName?1:0}return o.value?null===d.value?[...o.value].sort(e):o.value?o.value.filter((e=>d.value?.includes(e.id))).sort(e):null:null}));return(a,n)=>o.value?((0,s.wg)(),(0,s.iD)("aside",Y,[(0,s.Wm)(U,{teachers:o.value,onInput:n[0]||(n[0]=e=>d.value=e)},null,8,["teachers"]),F,T,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)((0,l.SU)(v),(a=>((0,s.wg)(),(0,s.iD)("button",{key:a.id,class:"checkbox",onClick:e=>t("select",a.id)},[(0,s.Wm)((0,l.SU)(r.XZ),{state:!!e.selectedIDs&&e.selectedIDs.includes(a.id)},null,8,["state"]),(0,s._)("span",null,(0,u.zw)(a.fullName),1)],8,W)))),128))])):(0,s.kq)("",!0)}});const M=(0,m.Z)(q,[["__scopeId","data-v-79b3773d"]]);var B=M;const K=e=>((0,s.dD)("data-v-639572dd"),e=e(),(0,s.Cn)(),e),L=i+"#tabler-circle-x",R=i+"#tabler-circle-check",z={class:"presence-user"},E={key:0,class:"absent",width:"24",height:"24",viewBox:"0 0 24 24"},G=K((()=>(0,s._)("use",{href:L},null,-1))),A=[G],V={key:1,class:"present",width:"24",height:"24",viewBox:"0 0 24 24"},X=K((()=>(0,s._)("use",{href:R},null,-1))),j=[X];var J=(0,s.aZ)({__name:"PresenceUser",props:{avatar:null,fullName:null,uid:null,badgeText:null,isPresent:{type:Boolean}},setup(e){return(t,a)=>((0,s.wg)(),(0,s.iD)("div",z,[e.isPresent?((0,s.wg)(),(0,s.iD)("svg",V,j)):((0,s.wg)(),(0,s.iD)("svg",E,A)),(0,s.Wm)((0,l.SU)(r.n5),{avatar:e.avatar,"full-name":e.fullName,"badge-text":e.badgeText},null,8,["avatar","full-name","badge-text"])]))}});const O=(0,m.Z)(J,[["__scopeId","data-v-639572dd"]]);var Q=O;const ee={key:0,class:"users-list"};var te=(0,s.aZ)({__name:"PresenceUsers",props:{usersData:null,checkStatus:null,filter:null},setup(e){const t=e,{users:a,fetchUsers:r}=I();(0,s.bv)((()=>r({usersData:t.usersData}))),(0,s.YP)((()=>t.usersData),(()=>r({usersData:t.usersData})));const u=(0,s.Fl)((()=>{function e(e,t){return e.fullName<t.fullName?-1:e.fullName>t.fullName?1:0}return a.value?"absent"===t.filter?[...a.value.filter((e=>!e.isPresent))].sort(e):"present"===t.filter?[...a.value.filter((e=>e.isPresent))].sort(e):[...a.value].sort(e):null}));return(t,r)=>(0,l.SU)(a)?((0,s.wg)(),(0,s.iD)("ul",ee,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)((0,l.SU)(u),(t=>((0,s.wg)(),(0,s.iD)("li",{key:t.uid,class:"user"},[(0,s.Wm)(Q,{avatar:t.avatar,"full-name":t.fullName,uid:t.uid,"badge-text":e.checkStatus?e.checkStatus(t.uid):void 0,"is-present":t.isPresent},null,8,["avatar","full-name","uid","badge-text","is-present"])])))),128))])):(0,s.kq)("",!0)}});const ae=(0,m.Z)(te,[["__scopeId","data-v-82cb59e4"]]);var se=ae;const le=e=>((0,s.dD)("data-v-4eff644c"),e=e(),(0,s.Cn)(),e),re=i+"#tabler-filter",ue=le((()=>(0,s._)("svg",{width:"24",height:"24"},[(0,s._)("use",{href:re})],-1))),ne={key:0,class:"filter-dropdown"};var ie=(0,s.aZ)({__name:"AttendanceFilter",props:{filter:null},emits:["switch"],setup(e,{emit:t}){const a=e,r=(0,l.iH)(!1),i=(0,s.Fl)((()=>"absent"===a.filter?"Отсутствуют":"present"===a.filter?"Присутствуют":"Все")),o=e=>{t("switch",e),r.value=!1};return(e,t)=>((0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("button",{class:"filter-button",onClick:t[0]||(t[0]=e=>r.value=!r.value)},[(0,s._)("span",null,(0,u.zw)((0,l.SU)(i)),1),ue]),r.value?((0,s.wg)(),(0,s.iD)("div",ne,[(0,s._)("button",{onClick:t[1]||(t[1]=e=>o("all"))},"Все"),(0,s._)("button",{onClick:t[2]||(t[2]=e=>o("present"))},"Присутствуют"),(0,s._)("button",{onClick:t[3]||(t[3]=e=>o("absent"))},"Отсутствуют")])):(0,s.kq)("",!0),r.value?((0,s.wg)(),(0,s.iD)("div",{key:1,class:"backdrop",onClick:t[4]||(t[4]=e=>r.value=!1),onKeydown:t[5]||(t[5]=(0,n.D2)((e=>r.value=!1),["esc"]))},null,32)):(0,s.kq)("",!0)],64))}});const oe=(0,m.Z)(ie,[["__scopeId","data-v-4eff644c"]]);var ce=oe;const de=e=>((0,s.dD)("data-v-a2abfef8"),e=e(),(0,s.Cn)(),e),ve=i+"#tabler-filter",pe=de((()=>(0,s._)("svg",{width:"24",height:"24"},[(0,s._)("use",{href:ve})],-1))),fe={key:0,class:"filter-dropdown"},me=["onClick"];var ge=(0,s.aZ)({__name:"GroupsFilter",props:{groups:null,currentGroupID:null},emits:["switch"],setup(e,{emit:t}){const a=e,r=(0,l.iH)(!1),i=e=>{t("switch",e),r.value=!1},o=(0,s.Fl)((()=>a.currentGroupID?a.groups.find((e=>e.groupID===a.currentGroupID))?.groupName??null:null));return(t,a)=>((0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("button",{class:"filter-button",onClick:a[0]||(a[0]=e=>r.value=!r.value)},[(0,s._)("span",null,(0,u.zw)((0,l.SU)(o)??"Все"),1),pe]),r.value?((0,s.wg)(),(0,s.iD)("div",fe,[(0,s._)("button",{onClick:a[1]||(a[1]=e=>i(null))},"Все"),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.groups,(e=>((0,s.wg)(),(0,s.iD)("button",{key:e.groupID,onClick:t=>i(e.groupID)},(0,u.zw)(e.groupName),9,me)))),128))])):(0,s.kq)("",!0),r.value?((0,s.wg)(),(0,s.iD)("div",{key:1,class:"backdrop",onClick:a[2]||(a[2]=e=>r.value=!1),onKeydown:a[3]||(a[3]=(0,n.D2)((e=>r.value=!1),["esc"]))},null,32)):(0,s.kq)("",!0)],64))}});const he=(0,m.Z)(ge,[["__scopeId","data-v-a2abfef8"]]);var De=he;const be=()=>{const e=e=>{const t=e.date.slice(6,10),a=e.date.slice(3,5),s=e.date.slice(0,2),l=e.date.slice(11,13),r=e.date.slice(14,16),u=e.date.slice(17),n=`${t}-${a}-${s}T${l}:${r}:${u}+03:00`,i=new Date(Date.parse(n)),o=1===`${i.getHours()}`.length?`0${i.getHours()}`:i.getHours(),c=1===`${i.getMinutes()}`.length?`0${i.getMinutes()}`:i.getMinutes(),d=1===`${i.getDate()}`.length?`0${i.getDate()}`:i.getDate(),v=1===`${i.getMonth()}`.length?`0${i.getMonth()}`:i.getMonth();return{...e,date:`${o}:${c} ${d}.${v}.${i.getFullYear()}`}};return{setTime:e}};var _e=be}}]);
//# sourceMappingURL=53.370b6acc.js.map